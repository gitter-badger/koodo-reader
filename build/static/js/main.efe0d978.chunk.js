(this["webpackJsonptest-reader"]=this["webpackJsonptest-reader"]||[]).push([[0],Array(25).concat([function(e,t,n){e.exports=n(74)},,,,,function(e,t,n){},,,,,function(e,t,n){},function(e,t,n){},,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(13),s=n.n(r),i=n(1),l=n(2),c=n(5),u=n(4),d=n(6),h=n(14),p=(n(30),n(3)),m=(n(35),n(36),function e(t,n,a,o,r){Object(i.a)(this,e),this.key=t,this.bookKey=n,this.cfi=a,this.color=r,this.range=o}),g=n(8),f=n.n(g),b=n(18),k=n.n(b),v=n(22),E=n(7),y=function(){function e(){Object(i.a)(this,e)}return Object(l.a)(e,null,[{key:"fuzzyQuery",value:function(e,t){for(var n=[],a=0;a<e.length;a++)null!=e[a].match(t)&&n.push(a);return n}},{key:"MergeArray",value:function(e,t){for(var n=[],a=0;a<e.length;a++)n.push(e[a]);for(var o=0;o<t.length;o++){for(var r=!0,s=0;s<e.length;s++)if(t[o]===e[s]){r=!1;break}r&&n.push(t[o])}return n}},{key:"MouseSearch",value:function(e){var t=document.querySelector(".header-search-box").value,n=[],a=[];e.forEach((function(e){n.push(e.name.toLowerCase()),a.push(e.author.toLowerCase())}));var o=this.fuzzyQuery(n,t),r=this.fuzzyQuery(a,t),s=this.MergeArray(o,r);return console.log(s.sort()),s}},{key:"KeySearch",value:function(e,t){if(e&&13===e.keyCode){var n=[],a=[];t.forEach((function(e){n.push(e.name.toLowerCase()),a.push(e.author.toLowerCase())}));var o=this.fuzzyQuery(n,e.target.value),r=this.fuzzyQuery(a,e.target.value),s=this.MergeArray(o,r);return console.log(s.sort()),s}}},{key:"setSortCode",value:function(e,t){var n=localStorage.getItem("sortCode"),a=JSON.parse(n)||{sort:2,order:2};a.sort=e,a.order=t,localStorage.setItem("sortCode",JSON.stringify(a))}},{key:"getSortCode",value:function(){var e=localStorage.getItem("sordCode");return JSON.parse(e)||{sort:2,order:2}||null}}]),e}(),O={books:null,epubs:null,covers:null,searchBooks:[],isSearch:!1,isSort:!0,isList:"card",isSortDisplay:!1,sortCode:{sort:2,order:2},isMessage:!1,message:"\u6dfb\u52a0\u6210\u529f"};function S(e){return{type:"HANDLE_SORT",payload:e}}function N(e){return{type:"HANDLE_LIST",payload:e}}function C(e){return console.log(e),{type:"HANDLE_MESSAGE",payload:e}}function j(e){return console.log(e),{type:"HANDLE_MESSAGE_BOX",payload:e}}function D(e){return console.log(e),{type:"HANDLE_SORT_CODE",payload:e}}function B(){return function(e){f.a.getItem("books",(function(t,n){var a=n;e({type:"HANDLE_BOOKS",payload:a});var o=[];null===a?o=null:a.forEach((function(t){var n=window.ePub({bookPath:t.content,restore:!1});o.push(n),e({type:"HANDLE_EPUBS",payload:o});var r=[];o.forEach(function(){var t=Object(v.a)(k.a.mark((function t(n,o){return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.coverUrl().then((function(t){r.push({key:a[o].key,url:t}),r.length===a.length&&e({type:"HANDLE_COVERS",payload:r})}));case 2:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())}))}))}}var x=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).handleReturn=function(){n.props.changeMenu("menu")},n.handleClose=function(){n.props.close()},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.currentEpub.on("renderer:ChapterDisplayed",(function(){e.getHighlighter()}))}},{key:"handleHighlight",value:function(e){var t=document.getElementsByTagName("iframe")[0],n=document.getElementsByTagName("iframe")[0].contentDocument,a=parseInt(e.target.dataset.color);if(!isNaN(a)){var o=(new Date).getTime()+"";this.props.highlighter.highlightSelection(["color-0","color-1","color-2","color-3"][a]);var r=this.props.currentBook,s=this.props.currentEpub,i=n.getSelection().getRangeAt(0),l=s.renderer.currentChapter.cfiBase,c=(new window.EPUBJS.EpubCFI).generateCfiFromRange(i,l),u=r.key,d=window.rangy.getSelection(t).saveCharacterRanges(n.body)[0],h=JSON.stringify(d);e.stopPropagation();var p=new m(o,u,c,h,a),g=this.props.highlighters?this.props.highlighters:[];g.push(p),f.a.setItem("highlighters",g),this.props.closeMenu(),n.getSelection().empty(),this.props.handleMessage("\u9ad8\u4eae\u6210\u529f"),this.props.handleMessageBox(!0),console.log("%c Add note here. ","background-color: green")}}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"highlight-list",style:e.props.isChangeDirection?{marginTop:"0px"}:{}},o.a.createElement("div",{className:"highlight-return-button",onClick:function(){e.handleReturn()}},o.a.createElement("span",{className:"icon-return"}),o.a.createElement("p",{className:"highlight-text"},"\u9009\u62e9\u989c\u8272")),o.a.createElement("ul",{className:"highlight-color"},o.a.createElement("li",{className:"highlight-color1",onClick:function(t){e.handleHighlight(t)},"data-color":"0"}),o.a.createElement("li",{className:"highlight-color2",onClick:function(t){e.handleHighlight(t)},"data-color":"1"}),o.a.createElement("li",{className:"highlight-color3",onClick:function(t){e.handleHighlight(t)},"data-color":"2"}),o.a.createElement("li",{className:"highlight-color4",onClick:function(t){e.handleHighlight(t)},"data-color":"3"})))}}]),t}(a.Component),A={handleMessageBox:j,handleMessage:C},I=x=Object(p.b)((function(e){return{currentEpub:e.book.currentEpub,currentBook:e.book.currentBook,notes:e.reader.notes,chapters:e.reader.chapters,highlighters:e.reader.highlighters}}),A)(x),M=(n(38),function e(t,n,a,o,r,s){Object(i.a)(this,e),this.key=(new Date).getTime()+"",this.bookKey=t,this.date={year:(new Date).getFullYear(),month:(new Date).getMonth()+1,day:(new Date).getDate()},this.chapter=n,this.text=a,this.cfi=o,this.range=r,this.notes=s||""}),w=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleReturn=function(){n.props.changeMenu("menu"),n.props.openMenu()},n.handleClose=function(){n.props.closeMenu()},n.state={},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"createNote",value:function(){var e=this.props.currentBook,t=this.props.currentEpub,n=document.getElementsByTagName("iframe")[0],a=n.contentDocument,o=a.getSelection(),r=o.getRangeAt(0);console.log(r,"range");var s=document.querySelector(".editor-box").value;document.querySelector(".editor-box").value="",console.log(s,"note");var i=o.toString();i=i&&i.trim();var l=t.renderer.currentChapter.cfiBase,c=(new window.EPUBJS.EpubCFI).generateCfiFromRange(r,l),u=e.key,d=window.rangy.getSelection(n).saveCharacterRanges(a.body)[0],h=JSON.stringify(d),p=this.props.chapters.findIndex((function(e){return e.spinePos>t.renderer.currentChapter.spinePos})),m=void 0!==this.props.chapters[p]?this.props.chapters[p].label.trim(" "):"\u672a\u77e5\u7ae0\u8282",g=new M(u,m,i,c,h,s),b=this.props.notes?this.props.notes:[];b.push(g),f.a.setItem("notes",b),this.props.closeMenu(),a.getSelection().empty(),this.props.handleMessage("\u6dfb\u52a0\u6210\u529f"),this.props.handleMessageBox(!0)}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"note-editor"},o.a.createElement("div",{className:"note-return-button",onClick:function(){e.handleReturn()}},o.a.createElement("span",{className:"icon-return"})),o.a.createElement("textarea",{type:"text",className:"editor-box",placeholder:"\u8bf7\u5728\u6b64\u8f93\u5165\u60a8\u7684\u7b14\u8bb0"}),o.a.createElement("span",{className:"confirm-button",onClick:function(){e.createNote()}},"\u786e\u8ba4"),o.a.createElement("span",{className:"cancel-button",onClick:function(){e.handleClose()}},"\u53d6\u6d88"))}}]),t}(a.Component),L={handleMessageBox:j,handleMessage:C},H=w=Object(p.b)((function(e){return{currentEpub:e.book.currentEpub,currentBook:e.book.currentBook,notes:e.reader.notes,chapters:e.reader.chapters}}),L)(w),F=(n(39),function e(t,n,a,o){Object(i.a)(this,e),this.key=(new Date).getTime()+"",this.date={year:(new Date).getFullYear(),month:(new Date).getMonth()+1,day:(new Date).getDate()},this.bookKey=t,this.chapter=n,this.text=a,this.cfi=o}),_={selection:null,highlighters:[]};function R(e){return console.log(e),{type:"HANDLE_OPEN_MENU",payload:e}}var P=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleNote=function(){n.props.changeMenu("note")},n.handleHighlight=function(){n.props.changeMenu("highlight")},n.handleCopy=function(){var e=document.getElementsByTagName("iframe")[0].contentDocument;e.execCommand("copy",!1,null)?console.log("copied!"):console.log("failed to copy text to clipboard"),n.props.closeMenu(),e.getSelection().empty(),n.props.handleMessage("\u590d\u5236\u6210\u529f"),n.props.handleMessageBox(!0)},n.handleDigest=function(){var e=n.props.currentBook,t=n.props.currentEpub,a=document.getElementsByTagName("iframe")[0].contentDocument,o=a.getSelection(),r=o.getRangeAt(0),s=o.toString();s=s&&s.trim();var i=t.renderer.currentChapter.cfiBase,l=(new window.EPUBJS.EpubCFI).generateCfiFromRange(r,i),c=e.key,u=n.props.chapters.findIndex((function(e){return e.spinePos>t.renderer.currentChapter.spinePos})),d=void 0!==n.props.chapters[u]?n.props.chapters[u].label.trim(" "):"\u672a\u77e5\u7ae0\u8282",h=new F(c,d,s,l),p=n.props.digests?n.props.digests:[];p.push(h),f.a.setItem("digests",p),n.props.closeMenu(),a.getSelection().empty(),n.props.handleMessage("\u6dfb\u52a0\u6210\u529f"),n.props.handleMessageBox(!0)},n.state={},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"menu-list"},o.a.createElement("div",{className:"note-option",onClick:function(){e.handleNote()}},o.a.createElement("div",null,o.a.createElement("span",{className:"icon-note note-icon"}),o.a.createElement("p",null,"\u8bb0\u7b14\u8bb0"))),o.a.createElement("div",{className:"digest-option",onClick:function(){e.handleDigest()}},o.a.createElement("div",null,o.a.createElement("span",{className:"icon-collect digest-icon"}),o.a.createElement("p",null,"\u6536\u85cf"))),o.a.createElement("div",{className:"highlight-option",onClick:function(){e.handleHighlight()}},o.a.createElement("div",null,o.a.createElement("span",{className:"icon-highlight highlight-icon"}),o.a.createElement("p",null,"\u9ad8\u4eae"))),o.a.createElement("div",{className:"copy-option icon",onClick:function(){e.handleCopy()}},o.a.createElement("div",null,o.a.createElement("span",{className:"icon-copy copy-icon"}),o.a.createElement("p",null,"\u590d\u5236"))))}}]),t}(a.Component),T={handleOpenNote:function(e){return{type:"HANDLE_OPEN_NOTE",payload:e}},handleOpenHighlight:function(e){return{type:"HANDLE_OPEN_HIGHLIGHT",payload:e}},handleOpenMenu:R,handleMessageBox:j,handleMessage:C},z=P=Object(p.b)((function(e){return{currentBook:e.book.currentBook,currentEpub:e.book.currentEpub,isOpenMenu:e.viewArea.isOpenMenu,selection:e.viewArea.selection,digests:e.reader.digests,chapters:e.reader.chapters}}),T)(P),G=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).setKey=function(e){console.log(e,"key"),n.setState({key:e})},n.getHighlighter=function(){var e=document.getElementsByTagName("iframe")[0].contentDocument;n.highlighter=window.rangy.createHighlighter(e);["color-0","color-1","color-2","color-3"].forEach((function(e){var t={ignoreWhiteSpace:!0,elementTagName:"span",elementProperties:{onclick:function(e){if(document.getElementsByTagName("iframe")[0].contentDocument.getSelection().isCollapsed){var t=e.currentTarget.dataset.key;console.log(t),n.openMenu(),e.stopPropagation()}}},onElementCreate:function(e){e.dataset.key=n.key}},a=window.rangy.createClassApplier(e,t);n.highlighter.addClassApplier(a),console.log("applier")}))},n.renderHighlighters=function(){console.log("%c renderNotes has been called! ","color: cyan; background: #333333");var e=n.props.highlighters,t=document.getElementsByTagName("iframe")[0],a=t.contentWindow||t.contentDocument.defaultView,o=window.rangy.getSelection(t),r=window.rangy.serializeSelection(o,!0);n.highlighter&&n.highlighter.removeAllHighlights();var s=["color-0","color-1","color-2","color-3"];null!==e&&e.forEach((function(e){n.key=e.key;try{var a=JSON.parse(e.range);a=[a],window.rangy.getSelection(t).restoreCharacterRanges(t.contentDocument,a)}catch(o){return void console.warn("Exception has been caught when restore character ranges.")}n.highlighter.highlightSelection(s[e.color])})),a.getSelection().empty(),n.state.isOpenMenu&&window.rangy.deserializeSelection(r,null,a)},n.openMenu=function(e){var t=document.getElementsByTagName("iframe")[0].contentDocument.getSelection();if(n.setState({isChangeDirection:!1}),n.state.isOpenMenu&&n.closeMenu(),console.log(n.state.isOpenMenu,"fhadh"),t.isCollapsed)n.props.isOpenMenu&&n.closeMenu();else{var a=n.props.currentEpub.renderer.rangePosition(t.getRangeAt(0));console.log(a);var o,r=a.x+a.width/2-20,s=n.props.currentEpub.renderer.width-154;console.log(n.props.currentEpub.renderer.width),a.y<200?(n.setState({isChangeDirection:!0}),o=a.y+77):o=a.y-100-a.height,o=o<6?6:o,r=r<10?10:"note"===n.state.mode&&a.x>s?s:r,n.setState({isOpenMenu:!0}),document.querySelector(".popup-menu-container").setAttribute("style","left:".concat(r,"px;top:").concat(o,"px"))}},n.closeMenu=function(){n.setState({isOpenMenu:!1})},n.changeMenu=function(e){n.setState({mode:e})},n.state={mode:"menu",isOpenMenu:!1,isChangeDirection:!1},n.highlighter=null,n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.currentEpub.on("renderer:chapterDisplayed",(function(){var t=e.props.currentEpub.renderer.doc;e.getHighlighter(),setTimeout((function(){e.renderHighlighters()}),100),t.addEventListener("click",e.openMenu)}))}},{key:"render",value:function(){return o.a.createElement("div",null,this.state.isOpenMenu?o.a.createElement("div",{className:"popup-menu-container"},o.a.createElement("div",{className:"popup-menu-box"},"menu"===this.state.mode?o.a.createElement(z,{closeMenu:this.closeMenu,changeMenu:this.changeMenu}):"note"===this.state.mode?o.a.createElement(H,{closeMenu:this.closeMenu,openMenu:this.openMenu,changeMenu:this.changeMenu}):o.a.createElement(I,{closeMenu:this.closeMenu,changeMenu:this.changeMenu,highlighter:this.highlighter,isChangeDirection:this.state.isChangeDirection})),this.state.isChangeDirection?o.a.createElement("span",{className:"icon-popup popup-menu-triangle-up",style:"highlight"===this.state.mode?{bottom:"110px"}:{}}):o.a.createElement("span",{className:"icon-popup popup-menu-triangle-down"})):null)}}]),t}(a.Component),J={handleSelection:function(e){return console.log("copy "),{type:"HANDLE_SELECTION",payload:e}}},K=G=Object(p.b)((function(e){return{currentEpub:e.book.currentEpub,isOpenMenu:e.viewArea.isOpenMenu,isOpenHighlight:e.viewArea.isOpenHighlight,isOpenNote:e.viewArea.isOpenNote,highlighters:e.reader.highlighters}}),J)(G),U=function(){function e(){Object(i.a)(this,e)}return Object(l.a)(e,null,[{key:"recordCfi",value:function(e,t,n){var a=localStorage.getItem("recordLocation"),o=JSON.parse(a)||{};o[e]={cfi:t,percentage:n},localStorage.setItem("recordLocation",JSON.stringify(o))}},{key:"getCfi",value:function(e){var t=localStorage.getItem("recordLocation");return(JSON.parse(t)||{})[e]||{}}},{key:"clear",value:function(e){var t=localStorage.getItem("recordLocation"),n=JSON.parse(t)||{};delete n[e],localStorage.setItem("recordLocation",JSON.stringify(n))}}]),e}(),q=[{id:1,theme:"rgba(235,255,231,1)"},{id:2,theme:"rgba(75,75,75,1)"},{id:3,theme:"rgba(242,219,187,1)"},{id:4,theme:"rgba(255,254,252,1)"}],W=[{id:1,size:"\u5c0f",num:15},{id:2,size:"\u4e2d",num:17},{id:3,size:"\u5927",num:20},{id:4,size:"\u7279\u5927",num:23},{id:5,size:"\u8d85\u5927",num:26}],Q=[{id:1,title:"\u5b57\u4f53",value:"fontFamily",option:[{id:1,name:"\u9ed8\u8ba4(\u601d\u6e90\u9ed1\u4f53)",value:"Source Han Sans CN"},{id:2,name:"\u601d\u6e90\u5b8b\u4f53",value:"Source Han Serif CN"},{id:3,name:"\u601d\u6e90\u9ed1\u4f53",value:"Source Han Sans CN"},{id:4,name:"\u5fae\u8f6f\u96c5\u9ed1",value:"Microsoft Yahei"},{id:5,name:"\u9ed1\u4f53",value:"SimHei"},{id:6,name:"Aril",value:"Aril"}]},{id:2,title:"\u884c\u95f4\u8ddd",value:"lineHeight",option:[{id:1,name:"\u9ed8\u8ba4(1.25\u500d)",value:1.25},{id:2,name:"1\u500d",value:1},{id:3,name:"1.25\u500d",value:1.25},{id:4,name:"1.5\u500d",value:1.5},{id:5,name:"1.75\u500d",value:1.75},{id:6,name:"2\u500d",value:2}]},{id:3,title:"\u9875\u8fb9\u8ddd",value:"padding",option:[{id:1,name:"\u9ed8\u8ba4(\u4e2d\u7b49)",value:50},{id:2,name:"\u8d85\u7a84",value:10},{id:3,name:"\u7a84",value:30},{id:4,name:"\u4e2d\u7b49",value:50},{id:5,name:"\u5bbd",value:70},{id:6,name:"\u8d85\u5bbd",value:90}]}],V=[{name:"\u5168\u90e8\u56fe\u4e66",icon:"home",mode:"home"},{name:"\u6700\u8fd1\u9605\u8bfb",icon:"recent",mode:"recent"},{name:"\u6211\u7684\u4e66\u7b7e",icon:"bookmark",mode:"bookmark"},{name:"\u6211\u7684\u7b14\u8bb0",icon:"idea",mode:"note"},{name:"\u6211\u7684\u4e66\u6458",icon:"digest",mode:"digest"}],Y=[{id:1,name:"Dropbox",icon:"dropbox"},{id:2,name:"OneDrive",icon:"onedrive"},{id:3,name:"Google Drive",icon:"googledrive"},{id:4,name:"Mega Drive",icon:"mega"},{id:5,name:"WebDav",icon:"webdav"}],X=[{mode:"home",main:"\u60a8\u7684\u56fe\u4e66\u5e93\u4e3a\u7a7a",sub:"\u8bf7\u70b9\u51fb\u53f3\u4e0a\u89d2\u7684\u56fe\u6807\u6dfb\u52a0\u56fe\u4e66"},{mode:"recent",main:"\u60a8\u6ca1\u6709\u9605\u8bfb\u8bb0\u5f55",sub:"\u70b9\u51fb\u4efb\u610f\u4e00\u672c\u4e66\u5f00\u59cb\u9605\u8bfb"},{mode:"bookmark",main:"\u60a8\u7684\u4e66\u7b7e\u4e3a\u7a7a",sub:"\u5728\u9605\u8bfb\u5668\u754c\u9762\uff0c\u5c06\u9f20\u6807\u79fb\u81f3\u4e0a\u8fb9\u7f18\u5904\uff0c\u5728\u5f39\u51fa\u7684\u83dc\u5355\u680f\u4e2d\u6dfb\u52a0\u4e66\u7b7e"},{mode:"note",main:"\u60a8\u7684\u7b14\u8bb0\u4e3a\u7a7a",sub:"\u5728\u9605\u8bfb\u5668\u754c\u9762\uff0c\u9009\u4e2d\u6587\u5b57\u540e\uff0c\u5728\u5f39\u51fa\u7684\u5bf9\u8bdd\u6846\u4e2d\u6dfb\u52a0\u7b14\u8bb0"},{mode:"digest",main:"\u60a8\u7684\u4e66\u6458\u4e3a\u7a7a",sub:"\u5728\u9605\u8bfb\u5668\u754c\u9762\uff0c\u9009\u4e2d\u6587\u5b57\u540e\uff0c\u5728\u5f39\u51fa\u7684\u5bf9\u8bdd\u6846\u4e2d\u70b9\u51fb\u6536\u85cf"},{mode:"shelf",main:"\u60a8\u7684\u4e66\u67b6\u4e3a\u7a7a",sub:"\u5c06\u9f20\u6807\u79fb\u52a8\u5230\u4efb\u610f\u4e66\u672c\u4e0a\u65b9\uff0c\u5728\u5f39\u51fa\u7684\u83dc\u5355\u4e2d\u70b9\u51fb\u52a0\u53f7\u6dfb\u52a0\u5230\u4e66\u67b6"}],Z=function(){function e(){Object(i.a)(this,e)}return Object(l.a)(e,null,[{key:"getDefaultConfigObj",value:function(){return{theme:"rgba(255,254,252,1)",fontFamily:"Source Han Sans CN",fontWeight:300,fontSize:17,lineHeight:1.25,column:2,padding:50,disablePopup:!1,progress:0,colors:["#FBF1D1","#EFEEB0","#CAEFC9","#76BEE9"]}}},{key:"get",value:function(){var t=localStorage.getItem("config");return JSON.parse(t)||e.getDefaultConfigObj()}},{key:"set",value:function(t,n){var a=localStorage.getItem("config"),o=JSON.parse(a)||e.getDefaultConfigObj();o[t]=n,localStorage.setItem("config",JSON.stringify(o))}},{key:"resetConfig",value:function(){var t=JSON.stringify(e.getDefaultConfigObj());localStorage.setItem("config",t)}},{key:"getDefaultCss",value:function(){var t=e.get(),n=t.colors;return"::selection{background:#f3a6a68c}::-moz-selection{background:#f3a6a68c}[class*=color-]:hover{cursor:pointer;background-image:linear-gradient(0,rgba(0,0,0,.075),rgba(0,0,0,.075))}.color-0{background-color:".concat(n[0],"}.color-1{background-color:").concat(n[1],"}.color-2{background-color:").concat(n[2],"}.color-3{background-color:").concat(n[3],"}")+["a, article, cite, code, div, li, p, pre, span, table {","    font-size: ".concat(t.fontSize+"px"," !important;"),"    line-height: ".concat(t.lineHeight," !important;"),"    letter-spacing: ".concat(t.letterSpacing+"px"," !important;"),'    font-family: "'.concat(t.fontFamily,'" !important;'),"}","img {","    max-width: 100% !important;","}"].join("\n")}}]),e}(),$=function(){function e(){Object(i.a)(this,e)}return Object(l.a)(e,null,[{key:"getStyle",value:function(e,t){return null!==e.currentStyle?e.currentStyle[t]:getComputedStyle(e)[t]}},{key:"addScript",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document,n=t.getElementById("qiu-user-script");if(!n)return(n=t.createElement("script")).id="qiu-user-script",n.type="text/javascript",n.defer=!0,n.text=e,void t.body.appendChild(n);n.text=e}},{key:"addCss",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document,n=t.getElementById("qiu-user-style");if(!n)return(n=t.createElement("style")).id="qiu-user-style",n.textContent=e,void t.head.appendChild(n);n.textContent=e}},{key:"addDefaultCss",value:function(){var e=Z.getDefaultCss(),t=document.getElementsByTagName("iframe")[0].contentDocument,n=t.getElementById("default-style");if(document.querySelector(".background").setAttribute("style","background-color:".concat(Z.get().theme)),!n)return(n=t.createElement("style")).id="default-style",n.textContent=e,void t.head.appendChild(n);n.textContent=e}},{key:"getUserStyle",value:function(){var e=localStorage.getItem("style")||"{}";return JSON.parse(e)}},{key:"parseStyle",value:function(e){var t=e.split("/* Qiu Plus Separator */");return{inner:t[0]||"",outer:t[1]||""}}},{key:"getUserScript",value:function(){var e=localStorage.getItem("script")||"{}";return JSON.parse(e)}},{key:"parseScript",value:function(e){var t=e.split("/* Qiu Plus Separator */");return{inner:t[0]||"",outer:t[1]||""}}},{key:"applyCss",value:function(){var t=document,n=document.getElementsByTagName("iframe")[0].contentDocument,a=e.getUserStyle();a.inner&&e.addCss(a.inner,n),a.outer&&e.addCss(a.outer,t)}},{key:"applyScript",value:function(){var t=document,n=document.getElementsByTagName("iframe")[0].contentDocument,a=e.getUserScript();a.inner&&e.addCss(a.inner,n),a.outer&&e.addCss(a.outer,t)}},{key:"resetStyle",value:function(){localStorage.setItem("style",JSON.stringify({inner:" ",outer:" "})),Z.resetConfig(),e.applyCss(),e.addDefaultCss()}},{key:"resetScript",value:function(){localStorage.setItem("script",JSON.stringify({inner:" ",outer:" "})),e.applyScript()}}]),e}(),ee={percentage:null,section:null,locations:null};function te(e){return console.log(e,"jkjlll"),{type:"HANDLE_PERCENTAGE",payload:e}}var ne=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={isSingle:localStorage.getItem("isSingle")||"double"},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentWillUnmount",value:function(){document.removeEventListener("copy",this.copyTextHack)}},{key:"componentDidMount",value:function(){var e=this,t=document.querySelector("#page-area");console.log(t,"fahfgf");var n=this.props.currentEpub;window.rangy.init(),n.renderTo(t),function(e,t){var n=-1!==navigator.userAgent.indexOf("Firefox"),a=!1,o=function(t){if(t.preventDefault(),!a)return 37===t.keyCode||38===t.keyCode?(e.prevPage(),a=!0,setTimeout((function(){a=!1}),100),!1):39===t.keyCode||40===t.keyCode?(e.nextPage(),a=!0,setTimeout((function(){a=!1}),100),!1):void 0},r=function(t){if(t.preventDefault(),!a)return t.detail<0?(e.prevPage(),a=!0,setTimeout((function(){a=!1}),100),!1):t.detail>0?(e.nextPage(),a=!0,setTimeout((function(){a=!1}),100),!1):void 0},s=function(t){if(console.log("wheel moving"),!a)return t.wheelDelta>0?(e.prevPage(),a=!0,setTimeout((function(){a=!1}),100),!1):t.wheelDelta<0?(e.nextPage(),a=!0,setTimeout((function(){a=!1}),100),!1):void 0},i=function(e){67===(e.keyCode||e.which)&&e.ctrlKey&&(document.getElementsByTagName("iframe")[0].contentDocument.execCommand("copy",!1,null)?console.log("copied!"):console.log("failed to copy text to clipboard"))};e.on("renderer:chapterDisplayed",(function(){var t=e.renderer.doc;t.addEventListener("keydown",o,!1),t.addEventListener("keydown",i),n?t.addEventListener("DOMMouseScroll",r,!1):t.addEventListener("mousewheel",s,!1),$.addDefaultCss(),$.applyCss()}))}(n,this.props.currentBook.key),n.on("renderer:locationChanged",(function(){var t=n.getCurrentLocationCfi();if(e.props.locations){var a=e.props.locations.percentageFromCfi(t);console.log(a,"sahafhfh"),U.recordCfi(e.props.currentBook.key,t,a),e.props.handlePercentage(a)}})),n.gotoCfi(null===U.getCfi(this.props.currentBook.key)?null:U.getCfi(this.props.currentBook.key).cfi),this.copyTextHack=function(e){var t=document.getElementsByTagName("iframe")[0].contentDocument.getSelection().toString()||document.getSelection().toString();e.clipboardData.setData("text/plain",t),e.preventDefault()},document.addEventListener("copy",this.copyTextHack)}},{key:"render",value:function(){return this.props.currentEpub.renderer.forceSingle("single"===this.state.isSingle),o.a.createElement("div",{className:"view-area-page",id:"page-area"})}}]),t}(a.Component),ae={handlePercentage:te,handleOpenMenu:R},oe=ne=Object(p.b)((function(e){return{currentBook:e.book.currentBook,currentEpub:e.book.currentEpub,locations:e.progressPanel.locations,isSingle:e.reader.isSingle}}),ae)(ne),re=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={isSingle:"double"},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"prev",value:function(){this.props.epub.prevPage(),this.closeMenu(),this.closeNoteCard()}},{key:"next",value:function(){this.props.epub.nextPage(),this.closeMenu(),this.closeNoteCard()}},{key:"render",value:function(){return console.log(this.state.isSingle),o.a.createElement("div",{className:"view-area"},o.a.createElement(K,{id:"popup-menu"}),o.a.createElement(oe,null))}}]),t}(a.Component),se=re=Object(p.b)((function(e){return{isSingle:e.reader.isSingle}}),{})(re),ie=(n(40),function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={isSingle:localStorage.getItem("isSingle")||"double"},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{className:"background"},o.a.createElement("div",{className:"background-box1"}),o.a.createElement("div",{className:"background-box2"}),o.a.createElement("div",{className:"background-box3"},o.a.createElement("div",{className:"spine-shadow-left",style:"single"===this.state.isSingle?{display:"none"}:{}},o.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"68",height:"800",viewBox:"0 0 68 800"},o.a.createElement("defs",null,o.a.createElement("linearGradient",{id:"linear-gradient",x1:"0.5",x2:"0.5",y2:"1",gradientUnits:"objectBoundingBox"},o.a.createElement("stop",{offset:"0",stopColor:"#fff",stopOpacity:"0"}),o.a.createElement("stop",{offset:"1",stopColor:"gray",stopOpacity:"0.388"}))),o.a.createElement("rect",{width:"800",height:"68",transform:"translate(0 800) rotate(-90)"}))),o.a.createElement("div",{className:"book-spine",style:"single"===this.state.isSingle?{display:"none"}:{}}),o.a.createElement("div",{className:"spine-shadow-right",style:"single"===this.state.isSingle?{display:"none"}:{}},o.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"68",height:"800",viewBox:"0 0 68 800"},o.a.createElement("defs",null,o.a.createElement("linearGradient",{id:"linear-gradient",x1:"0.5",x2:"0.5",y2:"1",gradientUnits:"objectBoundingBox"},o.a.createElement("stop",{offset:"0",stopColor:"#fff",stopOpacity:"0"}),o.a.createElement("stop",{offset:"1",stopColor:"gray",stopOpacity:"0.388"}))),o.a.createElement("rect",{width:"800",height:"68",transform:"translate(68) rotate(90)"})))))}}]),t}(a.Component)),le=ie=Object(p.b)((function(e){return{isSingle:e.reader.isSingle}}),{})(ie),ce=(n(41),n(42),function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={currentBackgroundIndex:q.findIndex((function(e){return e.theme===n.props.theme}))},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"handleChangeColor",value:function(e,t){Z.set("theme",e),this.setState({currentBackgroundIndex:t}),$.addDefaultCss()}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"background-color-setting"},o.a.createElement("div",{className:"background-color-text"},"\u80cc\u666f\u989c\u8272"),o.a.createElement("ul",{className:"background-color-list"},q.map((function(t,n){return o.a.createElement("li",{key:t.id,className:n===e.state.currentBackgroundIndex?"active-color background-color-circle":"background-color-circle",onClick:function(){e.handleChangeColor(t.theme,n)},style:{backgroundColor:t.theme}})}))))}}]),t}(a.Component)),ue=ce=Object(p.b)((function(e){return{theme:e.settingPanel.theme}}),{})(ce),de=(n(43),function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={currentFontSizeIndex:W.findIndex((function(e){return e.num===n.props.fontSize}))},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"handleFontSize",value:function(e,t){Z.set("fontSize",e),this.setState({currentFontSizeIndex:t}),$.addDefaultCss()}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"font-size-setting"},o.a.createElement("div",{className:"font-size-title"},"\u5b57\u53f7\u5927\u5c0f"),o.a.createElement("span",{className:"ultra-small-size"},"A"),o.a.createElement("div",{className:"font-size-line"}),o.a.createElement("ul",{className:"font-size-selector"},W.map((function(t,n){return o.a.createElement("li",{className:"font-size-description",key:t.id},o.a.createElement("div",{className:n===e.state.currentFontSizeIndex?"active-font-size font-size-circle":"font-size-circle",onClick:function(){return e.handleFontSize(t.num,n)}}),o.a.createElement("p",{className:"font-size-text"},t.size))}))),o.a.createElement("span",{className:"ultra-large-size"},"A"))}}]),t}(a.Component)),he=de=Object(p.b)((function(e){return{fontSize:e.settingPanel.fontSize}}),{})(de),pe=(n(44),function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={currentFontFamilyIndex:Q[0].option.findIndex((function(e){return e.value===n.props.fontFamily})),currentLineHeightIndex:Q[1].option.findIndex((function(e){return console.log(e.value,n.props.lineHeight,"adhsdjgh"),e.value===parseFloat(n.props.lineHeight)})),currentPaddingIndex:Q[2].option.findIndex((function(e){return e.value===parseInt(n.props.padding)}))},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){document.querySelector(".paragraph-character-setting").children[0].children[1].children[this.state.currentFontFamilyIndex].setAttribute("selected","selected"),document.querySelector(".paragraph-character-setting").children[1].children[1].children[this.state.currentLineHeightIndex].setAttribute("selected","selected"),document.querySelector(".paragraph-character-setting").children[2].children[1].children[this.state.currentPaddingIndex].setAttribute("selected","selected")}},{key:"handleView",value:function(e,t){var n=e.target.value.split(",");switch(Z.set(t,n[0]),console.log(t,n[0],"sasfhfshg"),t){case"font":this.setState({currentFontIndex:n[1]});break;case"fontWeight":this.setState({currentFontWeightIndex:n[1]});break;case"lineHeight":this.setState({currentLineHeightIndex:n[1]});break;case"padding":this.setState({currentPaddingIndex:n[1]});break;case"wordSpacing":this.setState({currentWordSpacingIndex:n[1]})}$.addDefaultCss()}},{key:"render",value:function(){var e=this;return o.a.createElement("ul",{className:"paragraph-character-setting"},Q.map((function(t,n){return o.a.createElement("li",{className:"paragraph-character-container",key:t.id},o.a.createElement("p",{className:"general-setting-title"},t.title),o.a.createElement("select",{name:"",className:"general-setting-dropdown",onChange:function(n){e.handleView(n,t.value)}},t.option.map((function(e,t){return o.a.createElement("option",{value:[e.value,t],className:"general-setting-option",key:e.id},e.name)}))))})))}}]),t}(a.Component)),me=pe=Object(p.b)((function(e){return{fontFamily:e.settingPanel.fontFamily,lineHeight:e.settingPanel.lineHeight,padding:e.settingPanel.padding}}),{})(pe),ge=(n(45),{bookmarks:null,notes:null,digests:null,locations:null,chapters:null,highlighters:null,isSingle:localStorage.getItem("isSingle")||"double"});function fe(e){return{type:"HANDLE_NOTES",payload:e}}function be(e){return{type:"HANDLE_BOOKMARKS",payload:e}}function ke(e){return{type:"HANDLE_DIGESTS",payload:e}}function ve(){return function(e){f.a.getItem("notes",(function(t,n){e(fe(null===n||n===[]?null:n))}))}}function Ee(){return function(e){f.a.getItem("bookmarks",(function(t,n){e(be(null===n||n===[]?null:n))}))}}function ye(){return function(e){f.a.getItem("digests",(function(t,n){e(ke(null===n||n===[]?null:n))}))}}function Oe(){return function(e){f.a.getItem("highlighters",(function(t,n){e({type:"HANDLE_HIGHLIGHTERS",payload:null===n||n===[]?null:n})}))}}var Se=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleClick=function(e){console.log(e,"sadfsahgj"),n.props.handleSingle(e),n.setState({isSingle:e}),localStorage.setItem("isSingle",e),n.props.handleMessage("\u9000\u51fa\u540e\u751f\u6548"),n.props.handleMessageBox(!0)},n.state={isSingle:localStorage.getItem("isSingle")||"double"},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"UNSAFE_componentWillMount",value:function(){console.log(this.state.isSingle)}},{key:"render",value:function(){var e=this;return console.log(this.state.isSingle),o.a.createElement("div",{className:"single-control-container"},o.a.createElement("div",{className:"single-mode-container",onClick:function(){e.handleClick("single")},style:"double"===this.state.isSingle?{opacity:.4}:{}},o.a.createElement("span",{className:"icon-single-page single-page-icon"}),o.a.createElement("div",{className:"single-mode-text"},"\u5355\u9875\u6a21\u5f0f")),o.a.createElement("div",{className:"double-mode-container",onClick:function(){e.handleClick("double")},style:"single"===this.state.isSingle?{opacity:.4}:{}},o.a.createElement("span",{className:"icon-two-page two-page-icon"}),o.a.createElement("div",{className:"double-mode-text"},"\u53cc\u9875\u6a21\u5f0f")))}}]),t}(a.Component),Ne={handleSingle:function(e){return{type:"HANDLE_SINGLE",payload:e}},handleMessageBox:j,handleMessage:C},Ce=Se=Object(p.b)((function(e){return{isSingle:e.reader.isSingle}}),Ne)(Se),je=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{className:"setting-panel"},o.a.createElement("div",{className:"setting-panel-title"},"\u9605\u8bfb\u9009\u9879"),o.a.createElement(Ce,null),o.a.createElement(ue,null),o.a.createElement(he,null),o.a.createElement(me,null))}}]),t}(a.Component),De=je=Object(p.b)((function(e){return{books:e.manager.books}}),{})(je),Be=(n(46),n(10)),xe=(n(47),function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={chapters:[]},n.handleJump=n.handleJump.bind(Object(Be.a)(n)),n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){var e=this;this.props.currentEpub.getToc().then((function(t){e.setState({chapters:t})}))}},{key:"handleJump",value:function(e){var t=e.target.getAttribute("href");console.log(this.props.currentEpub,t,"sfhfdhdfhf"),this.props.currentEpub.goto(t),e.preventDefault()}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"book-content-container"},o.a.createElement("ul",{className:"book-content"},e.state.chapters.map((function(t,n){var a=t.subitems&&t.subitems.length;return o.a.createElement("li",{className:"book-content-list",key:n},o.a.createElement("a",{href:t.href,onClick:e.handleJump,className:"book-content-name"},t.label),a?o.a.createElement("ul",null,t.subitems.map((function(t,n){return o.a.createElement("li",{key:n,className:"book-subcontent-list"},o.a.createElement("a",{href:t.href,onClick:e.handleJump,className:"book-subcontent-name"},t.label))}))):null)}))))}}]),t}(a.Component)),Ae=xe=Object(p.b)((function(e){return{currentEpub:e.book.currentEpub}}),{})(xe),Ie=(n(48),function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={bookmarks:n.props.bookmarks},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componenetDidMount",value:function(){var e=this;setInterval((function(){console.log(e.props.state)}),1e3)}},{key:"handleJump",value:function(e){console.log(e,"afhahhhh"),this.props.currentEpub.gotoCfi(e)}},{key:"render",value:function(){var e=this;console.log(this.props.bookmarks,"bookmarkks");return o.a.createElement("div",{className:"book-bookmark-container"},o.a.createElement("ul",{className:"book-bookmark"},function(){var t=e.state.bookmarks;return console.log(t),t.filter((function(t){return t.bookKey===e.props.currentBook.key})).map((function(t){return o.a.createElement("li",{className:"book-bookmark-list",key:t.key},o.a.createElement("p",{className:"book-bookmark-digest"},t.label),o.a.createElement("span",{className:"book-bookmark-index"},t.chapter),o.a.createElement("div",{className:"book-bookmark-progress"},Math.floor(100*t.percentage),"%"),o.a.createElement("div",{className:"book-bookmark-link",onClick:function(){e.handleJump(t.cfi)},style:{cursor:"pointer"}},"\u70b9\u51fb\u8df3\u8f6c"))}))}()))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.bookmarks!==t.bookmarks?{bookmarks:e.bookmarks}:null}}]),t}(a.Component)),Me=Ie=Object(p.b)((function(e){return{state:e,currentBook:e.book.currentBook,currentEpub:e.book.currentEpub,bookmarks:e.reader.bookmarks}}),{})(Ie),we=function(){function e(){Object(i.a)(this,e)}return Object(l.a)(e,null,[{key:"setTime",value:function(e,t){var n=localStorage.getItem("readingTime"),a=JSON.parse(n)||{};a[e]=t,localStorage.setItem("readingTime",JSON.stringify(a))}},{key:"getTime",value:function(e){var t=localStorage.getItem("readingTime");return(JSON.parse(t)||{})[e]||0}},{key:"clearTime",value:function(e){var t=localStorage.getItem("readingTime"),n=JSON.parse(t)||{};delete n[e],localStorage.setItem("readingTime",JSON.stringify(n))}}]),e}(),Le=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleClick=function(e){n.setState({isContentShow:e})},n.state={isContentShow:!0,chapters:[],cover:"",searchList:null,time:we.getTime(n.props.currentBook.key)},n.timer=null,n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.timer=setInterval((function(){var t=e.state.time;t+=1,e.setState({time:t})}),1e3),this.props.currentEpub.coverUrl().then((function(t){e.setState({cover:t})})),this.props.handleFetchBookmarks()}},{key:"componentWillUnmount",value:function(){clearInterval(this.timer),we.setTime(this.props.currentBook.key,this.state.time)}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"navigation-panel"},o.a.createElement("div",{className:"navigation-header"},o.a.createElement("img",{className:"book-cover",src:this.state.cover,alt:""}),o.a.createElement("div",{className:"book-title-container"},o.a.createElement("p",{className:"book-title"},this.props.currentBook.name)),o.a.createElement("p",{className:"book-arthur"},"\u4f5c\u8005:"," ",this.props.currentBook.arthur?this.props.currentBook.arthur:"\u672a\u77e5"),o.a.createElement("span",{className:"reading-duration"},"\u5df2\u8bfb: ",Math.floor(this.state.time/60),"\u5206\u949f"),o.a.createElement("div",{className:"navigation-navigation"},o.a.createElement("span",{className:"book-content-title",onClick:function(){e.handleClick(!0)},style:this.state.isContentShow?{color:"rgba(112, 112, 112, 1)"}:{color:"rgba(217, 217, 217, 1)"}},"\u76ee\u5f55"),o.a.createElement("span",{className:"book-bookmark-title",style:this.state.isContentShow?{color:"rgba(217, 217, 217, 1)"}:{color:"rgba(112, 112, 112, 1)"},onClick:function(){e.handleClick(!1)}},"\u4e66\u7b7e"))),o.a.createElement("div",{className:"navigation-body"},this.state.isContentShow?o.a.createElement(Ae,null):o.a.createElement(Me,null)))}}]),t}(a.Component),He={handleFetchBookmarks:Ee},Fe=Le=Object(p.b)((function(e){return{currentEpub:e.book.currentEpub,currentBook:e.book.currentBook,bookmarks:e.reader.bookmarks}}),He)(Le),_e=(n(49),function e(t,n,a,o,r){Object(i.a)(this,e),this.key=(new Date).getTime()+"",this.bookKey=t,this.cfi=n,this.label=a,this.percentage=o,this.chapter=r}),Re={isOpenEditDialog:!1,isOpenDeleteDialog:!1,isOpenAddDialog:!1,isReading:!1,currentBook:{},currentEpub:{},isRedirect:!1};function Pe(e){return{type:"HANDLE_EDIT_DIALOG",payload:e}}function Te(e){return{type:"HANDLE_DELETE_DIALOG",payload:e}}function ze(e){return{type:"HANDLE_ADD_DIALOG",payload:e}}function Ge(e){return{type:"HANDLE_READING_STATE",payload:e}}function Je(e){return{type:"HANDLE_READING_BOOK",payload:e}}function Ke(e){return{type:"HANDLE_READING_EPUB",payload:e}}var Ue=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={isFullScreen:!1,isBookmark:!1},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"handleScreen",value:function(){this.state.isFullScreen?this.handleExitFullScreen():this.handleFullScreen()}},{key:"handleFullScreen",value:function(){var e=document.documentElement;e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen(),this.setState({isFullScreen:!0})}},{key:"handleExitFullScreen",value:function(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen(),this.setState({isFullScreen:!1})}},{key:"handleAddBookmark",value:function(){var e=this,t=this.props.currentBook.key,n=this.props.currentEpub,a=null===U.getCfi(this.props.currentBook.key)?0:U.getCfi(this.props.currentBook.key).cfi,o=n.renderer.findFirstVisible(),r=o?o.textContent:"";r=(r=r&&r.trim())||a;var s=null===U.getCfi(this.props.currentBook.key)?0:U.getCfi(this.props.currentBook.key).percentage,i=this.props.chapters.findIndex((function(t){return t.spinePos>e.props.currentEpub.spinePos})),l="\u672a\u77e5\u7ae0\u8282";void 0!==this.props.chapters[i]&&(l=this.props.chapters[i].label.trim(" "));var c=new _e(t,a,r,s,l),u=this.props.bookmarks?this.props.bookmarks:[];u.push(c),console.log(u,"bookmarkArr"),this.props.handleBookmarks(u),f.a.setItem("bookmarks",u),this.setState({isBookmark:!0}),this.props.handleMessage("\u6dfb\u52a0\u6210\u529f"),this.props.handleMessageBox(!0)}},{key:"handleExit",value:function(){this.props.handleReadingState(!1);var e=this.props.currentEpub.getCurrentLocationCfi(),t=this.props.currentEpub.locations.percentageFromCfi(e);U.recordCfi(this.props.currentBook.key,e,t)}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"book-operation-panel"},o.a.createElement("div",{className:"exit-reading-button",onClick:function(){e.handleExit()}},o.a.createElement("span",{className:"icon-exit exit-reading-icon"}),o.a.createElement("span",{className:"exit-reading-text"},"\u9000\u51fa\u9605\u8bfb")),o.a.createElement("div",{className:"add-bookmark-button",onClick:function(){e.handleAddBookmark()}},o.a.createElement("span",{className:"icon-add add-bookmark-icon"}),o.a.createElement("span",{className:"add-bookmark-text"},"\u6dfb\u52a0\u4e66\u7b7e")),o.a.createElement("div",{className:"enter-fullscreen-button",onClick:function(){e.handleScreen()}},o.a.createElement("span",{className:"icon-fullscreen enter-fullscreen-icon"}),this.state.isFullScreen?o.a.createElement("span",{className:"enter-fullscreen-text"},"\u9000\u51fa\u5168\u5c4f"):o.a.createElement("span",{className:"enter-fullscreen-text"},"\u8fdb\u5165\u5168\u5c4f")))}}]),t}(a.Component),qe={handleBookmarks:be,handleReadingState:Ge,handleFetchBookmarks:Ee,handleMessageBox:j,handleMessage:C},We=Ue=Object(p.b)((function(e){return{state:e,currentEpub:e.book.currentEpub,currentBook:e.book.currentBook,bookmarks:e.reader.bookmarks,chapters:e.reader.chapters}}),qe)(Ue),Qe=(n(50),function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={message:n.props.message},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.setState({message:e.message})}},{key:"render",value:function(){return o.a.createElement("div",{className:"message-box-container"},o.a.createElement("span",{className:"icon-message  message-box-icon"}),o.a.createElement("div",{className:"message-content"},this.state.message))}}]),t}(a.Component)),Ve=Qe=Object(p.b)((function(e){return{message:e.manager.message}}),{})(Qe),Ye=(n(51),function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).onProgressChange=function(e){var t=e.target.value/100,a=t>=0?n.props.locations.cfiFromPercentage(t):0;n.props.currentEpub.gotoCfi(a)},n.onProgressInput=function(e){n.setState({displayPercentage:e.target.value/100}),console.log(n.state.displayPercentage,"kgdkdk")},n.previourChapter=function(){var e=n.props.currentEpub.spinePos;n.props.currentEpub.displayChapter(e-1,!1);var t=null===U.getCfi(n.props.currentBook.key)?0:U.getCfi(n.props.currentBook.key).percentage;console.log(t,"sfhfhg"),n.setState({displayPercentage:t})},n.nextChapter=function(){var e=n.props.currentEpub.spinePos;n.props.currentEpub.displayChapter(e+1,!1);var t=null===U.getCfi(n.props.currentBook.key)?0:U.getCfi(n.props.currentBook.key).percentage;console.log(t,"sfhfhg"),n.setState({displayPercentage:t})},n.state={displayPercentage:void 0!==n.props.percentage?n.props.percentage:0},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"UNSAFE_componentWillMount",value:function(){this.props.handleFetchLocations(this.props.currentEpub)}},{key:"render",value:function(){var e=this;return console.log(this.state.displayPercentage,"sfhfsah"),o.a.createElement("div",{className:"progress-panel"},o.a.createElement("p",{className:"progress-text"},"\u5f53\u524d\u8fdb\u5ea6:",Math.round(100*this.state.displayPercentage),"%"),o.a.createElement("input",{className:"input-progress",defaultValue:Math.round(100*this.state.displayPercentage),type:"range",max:"100",min:"0",step:"1",onMouseUp:function(t){e.onProgressChange(t)},onChange:function(t){e.onProgressInput(t)}}),o.a.createElement("div",{className:"previous-chapter",onClick:function(){e.previourChapter()}},o.a.createElement("span",{className:"icon-dropdown previous-chapter-icon"}," ")),o.a.createElement("div",{className:"next-chapter",onClick:function(){e.nextChapter()}},o.a.createElement("span",{className:"icon-dropdown next-chapter-icon"})))}}]),t}(a.Component)),Xe={handleFetchLocations:function(e){return function(t){console.log(e),void 0!==e.locations&&e.locations.generate().then((function(n){var a=e.locations;console.log("sfhafshfhafh"),t(function(e){return{type:"HANDLE_LOCATIONS",payload:e}}(a))}))}}},Ze=Ye=Object(p.b)((function(e){return{currentEpub:e.book.currentEpub,currentBook:e.book.currentBook,percentage:e.progressPanel.percentage,locations:e.progressPanel.locations,section:e.progressPanel.section}}),Xe)(Ye),$e=(n(52),function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleEnter=function(e){switch(console.log("enter"),e){case"right":n.setState({isOpenSettingPanel:!n.state.isOpenSettingPanel});break;case"left":n.setState({isOpenInfoPanel:!n.state.isOpenInfoPanel});break;case"top":n.setState({isOpenOperationPanel:!n.state.isOpenOperationPanel});break;case"bottom":n.setState({isOpenProgressPanel:!n.state.isOpenProgressPanel})}},n.handleLeave=function(e){switch(console.log("leave"),e){case"right":n.setState({isOpenSettingPanel:!1});break;case"left":n.setState({isOpenInfoPanel:!1});break;case"top":n.setState({isOpenOperationPanel:!1});break;case"bottom":n.setState({isOpenProgressPanel:!1})}},n.state={isOpenSettingPanel:!1,isOpenOperationPanel:!1,isOpenProgressPanel:!1,isOpenInfoPanel:!1,isMessage:!1},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){this.props.handleFetchBookmarks(),this.props.handleFetchPercentage(this.props.currentBook),this.props.handleFetchNotes(),this.props.handleFetchDigests(),this.props.handleFetchHighlighters(),this.props.handleFetchChapters(this.props.currentEpub)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this;this.setState({isMessage:e.isMessage}),e.isMessage&&setTimeout((function(){t.props.handleMessageBox(!1),t.setState({isMessage:!1})}),2e3),console.log(this.state.isMessage,"asdgsgjhf")}},{key:"componentDidMount",value:function(){window.rangy.init()}},{key:"setConfig",value:function(e,t){this.setState(Object(h.a)({},e,t))}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"viewer"},this.state.isMessage?o.a.createElement(Ve,null):null,o.a.createElement("div",{className:"left-panel",onMouseEnter:function(){e.handleEnter("left")}}),o.a.createElement("div",{className:"right-panel",onMouseEnter:function(){e.handleEnter("right")}}),o.a.createElement("div",{className:"top-panel",onMouseEnter:function(){e.handleEnter("top")}}),o.a.createElement("div",{className:"bottom-panel",onMouseEnter:function(){e.handleEnter("bottom")}}),o.a.createElement(se,{className:"view-area"}),this.state.isOpenSettingPanel?o.a.createElement("div",{onMouseLeave:function(){e.handleLeave("right")}},o.a.createElement(De,{className:"setting-panel"})):null,this.state.isOpenInfoPanel?o.a.createElement("div",{onMouseLeave:function(){e.handleLeave("left")}},o.a.createElement(Fe,{className:"navigation-panel"})):null,this.state.isOpenProgressPanel?o.a.createElement("div",{className:"progress-panel-container",onMouseLeave:function(){e.handleLeave("bottom")}},o.a.createElement(Ze,{className:"progress-panel"})):null,this.state.isOpenOperationPanel?o.a.createElement("div",{className:"operation-panel-container",onMouseLeave:function(){e.handleLeave("top")}},o.a.createElement(We,{className:"book-operation-panel"})):null,o.a.createElement(le,{className:"background"}))}}]),t}(a.Component)),et={handleNotes:fe,handleBookmarks:be,handleDigests:ke,handleFetchNotes:ve,handleFetchBookmarks:Ee,handleFetchDigests:ye,handleFetchChapters:function(e){return function(t){e.getToc().then((function(e){t(function(e){return{type:"HANDLE_CHAPTERS",payload:e}}(e))}))}},handleFetchHighlighters:Oe,handleMessageBox:j,handleFetchPercentage:function(e){return function(t){var n=U.getCfi(e.key).percentage;console.log(n,"percentage"),t(te(n))}}},tt=$e=Object(p.b)((function(e){return{currentEpub:e.book.currentEpub,currentBook:e.book.currentBook,isMessage:e.manager.isMessage}}),et)($e),nt=(n(53),{mode:"home",shelfIndex:null});var at={"\u65b0\u5efa\u4e66\u67b6":null,"\u5de5\u4f5c\u5b66\u4e60":[],"\u751f\u6d3b\u767e\u79d1":[],"\u4f11\u95f2\u5a31\u4e50":[]},ot=function(){function e(){Object(i.a)(this,e)}return Object(l.a)(e,null,[{key:"setShelf",value:function(e,t){var n=localStorage.getItem("shelfList"),a=JSON.parse(n)||at;void 0===a[e]&&(a[e]=[]),-1===a[e].indexOf(t)&&a[e].unshift(t),localStorage.setItem("shelfList",JSON.stringify(a))}},{key:"getShelf",value:function(){var e=localStorage.getItem("shelfList");return JSON.parse(e)||at||null}},{key:"clearShelf",value:function(e,t){var n=localStorage.getItem("shelfList"),a=JSON.parse(n)||at,o=a[e].findIndex(t);a[e].splice(o,1),localStorage.setItem("shelfList",JSON.stringify(a))}},{key:"removeShelf",value:function(e){var t=localStorage.getItem("shelfList"),n=JSON.parse(t)||at;delete n.shelfTitle,localStorage.setItem("shelfList",JSON.stringify(n))}}]),e}(),rt=(n(54),function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleGithub=function(e){n.setState({isGithub:e})},n.handleContact=function(e){n.setState({isContact:e})},n.handleDonate=function(e){n.setState({isDonate:e})},n.state={isNew:!1,isGithub:!1,isContact:!1,isDonate:!1},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"about-container"},this.state.isGithub?o.a.createElement("div",{className:"about-box"},o.a.createElement("div",{className:"about-message"},"\u672c\u9879\u76ee\u6240\u6709\u4ee3\u7801\u5747\u5df2\u5728GitHub\u4e0a\u5f00\u6e90\uff0c\u70b9\u51fb\u524d\u5f80\u67e5\u770b")):null,this.state.isContact?o.a.createElement("div",{className:"about-box"},o.a.createElement("div",{className:"about-message"},"\u5411\u5f00\u53d1\u8005\u53cd\u9988\u60a8\u5728\u4f7f\u7528\u8fc7\u7a0b\u4e2d\u9047\u5230\u7684\u95ee\u9898\u548c\u6539\u8fdb\u5efa\u8bae")):null,this.state.isDonate?o.a.createElement("div",{className:"about-box"},o.a.createElement("div",{className:"about-message"},"\u7ef4\u62a4\u672c\u9879\u76ee\u9700\u8981\u5360\u7528\u5927\u91cf\u65f6\u95f4\uff0c\u5982\u679c\u60a8\u89c9\u5f97\u672c\u9879\u76ee\u5bf9\u60a8\u6709\u5e2e\u52a9\uff0c\u6b22\u8fce\u6253\u8d4f\u5f00\u53d1\u8005")):null,o.a.createElement("div",{className:"about-icon-container"},o.a.createElement("a",{href:"http://www.baidu.com",target:"_blank",rel:"noopener noreferrer"},o.a.createElement("span",{className:"icon-github about-icon",onMouseEnter:function(){e.handleGithub(!0)},onMouseLeave:function(){e.handleGithub(!1)}})),o.a.createElement("span",{className:"icon-contact about-icon",onMouseEnter:function(){e.handleContact(!0)},onMouseLeave:function(){e.handleContact(!1)}}),o.a.createElement("span",{className:"icon-donate about-icon",onMouseEnter:function(){e.handleDonate(!0)},onMouseLeave:function(){e.handleDonate(!1)}})))}}]),t}(a.Component)),st=rt=Object(p.b)((function(e){return{}}),{})(rt),it=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleSidebar=function(e,t){console.log(t),n.setState({index:t}),n.setState({shelfIndex:null}),n.setState({isCollapse:!0}),n.props.handleMode(e),n.props.handleShelfIndex(null)},n.handleShelf=function(){n.setState({isCollapse:!n.state.isCollapse})},n.handleShelfItem=function(e){console.log(e),n.setState({shelfIndex:e}),n.props.handleShelfIndex(e),n.props.handleMode("shelf")},n.state={index:["home","recent","bookmark","note","digest"].indexOf(n.props.mode),isCollapse:!0,shelfIndex:null},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"sidebar"},o.a.createElement("img",{src:"../../assets/logo.jpg",alt:"",className:"logo"}),o.a.createElement("ul",{className:"side-menu-container"},V.map((function(t,n){return o.a.createElement("li",{key:t.name,className:e.state.index===n&&null===e.state.shelfIndex?"active side-menu-item":"side-menu-item",id:"sidebar-".concat(t.icon),onClick:function(){e.handleSidebar(t.mode,n)}},e.state.index===n&&null===e.state.shelfIndex?o.a.createElement("div",{className:"side-menu-selector-container"}):null,o.a.createElement("div",{className:e.state.index===n&&null===e.state.shelfIndex?"side-menu-selector active-selector":"side-menu-selector "},o.a.createElement("span",{className:e.state.index===n&&null===e.state.shelfIndex?"icon-".concat(t.icon," side-menu-icon  active-icon"):"icon-".concat(t.icon," side-menu-icon")}),t.name))})),o.a.createElement("li",{className:"side-menu-shelf"},o.a.createElement("div",{onClick:function(){e.handleShelf()}},o.a.createElement("span",{className:"icon-shelf"}),"\u6211\u7684\u4e66\u67b6",o.a.createElement("span",{className:this.state.isCollapse?"icon-dropdown":"icon-shangla"})),o.a.createElement("ul",{className:"shelf-list-container",style:this.state.isCollapse?{display:"none"}:{}},function(){var t=Object.keys(ot.getShelf());return t.splice(0,1),t.map((function(t,n){return o.a.createElement("li",{key:n,className:e.state.shelfIndex===n?"shelf-list-item active-shelf ":"shelf-list-item",onClick:function(){e.handleShelfItem(n)}},t)}))}()))),o.a.createElement(st,null))}}]),t}(a.Component),lt={handleMode:function(e){return console.log(e),{type:"HANDLE_MODE",payload:e}},handleShelfIndex:function(e){return console.log(e),{type:"HANDLE_SHELF_INDEX",payload:e}}},ct=it=Object(p.b)((function(e){return{mode:e.sidebar.mode}}),lt)(it),ut=(n(55),n(56),function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).UNSAFE_componentWillReceiveProps=function(e){n.setState({isSearch:e.isSearch})},n.handleMouse=function(){var e=y.MouseSearch(n.props.books);n.props.handleSearchBooks(e),n.props.handleSearch(!0)},n.handleKey=function(e){var t=y.KeySearch(e,n.props.books);void 0!==t&&(n.props.handleSearchBooks(t),n.props.handleSearch(!0))},n.handleCancel=function(){n.props.handleSearch(!1),document.querySelector(".header-search-box").value=""},n.state={isSearch:n.props.isSearch},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"header-search-container"},o.a.createElement("input",{type:"text",placeholder:"\u641c\u7d22\u6211\u7684\u4e66\u5e93",className:"header-search-box",onKeyDown:function(t){e.handleKey(t)}}),this.props.isSearch?o.a.createElement("span",{className:"header-search-text",onClick:function(){e.handleCancel()}},"\u53d6\u6d88"):o.a.createElement("span",{className:"icon-search header-search-icon",onClick:function(){e.handleMouse()}}))}}]),t}(a.Component)),dt={handleFetchBooks:B,handleSearchBooks:function(e){return{type:"HANDLE_SEARCH_BOOKS",payload:e}},handleSearch:function(e){return{type:"HANDLE_SEARCH",payload:e}}},ht=ut=Object(p.b)((function(e){return{books:e.manager.books,isSearch:e.manager.isSearch}}),dt)(ut),pt=(n(57),function e(t,n,a,o,r){Object(i.a)(this,e),this.key=(new Date).getTime()+"",this.name=t,this.author=n,this.description=a,this.content=o,this.md5=r}),mt=n(23),gt=n.n(mt),ft=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleAddBook=function(e){var t=n.props.books;console.log(t,"bookArr"),null==t&&(t=[]),t.push(e),console.log(t,"sghasfkh"),f.a.setItem("books",t).then((function(){console.log("hadfhafh"),n.props.handleFetchBooks()})),n.props.handleMessage("\u6dfb\u52a0\u6210\u529f"),n.props.handleMessageBox(!0)},n.doIncrementalTest=function(e){var t=File.prototype.slice||File.prototype.mozSlice||File.prototype.webkitSlice,a=Math.ceil(e.size/2097152),o=0,r=new gt.a,s=new FileReader;function i(){var n=2097152*o,a=n+2097152>=e.size?e.size:n+2097152;s.readAsBinaryString(t.call(e,n,a))}s.onload=function(t){if(r.appendBinary(t.target.result),(o+=1)<a)i();else{console.log("Finished loading!");var s=r.end();n.handleBook(e,s)}},i()},n.handleBook=function(e,t){if(null!==n.props.books&&n.props.books.forEach((function(e){e.md5===t&&(n.setState({isRepeat:!0}),n.props.handleMessage("\u6587\u4ef6\u91cd\u590d"),n.props.handleMessageBox(!0))})),!n.state.isRepeat){var a=new FileReader;a.readAsArrayBuffer(e),a.onload=function(e){window.ePub({bookPath:e.target.result}).getMetadata().then((function(a){var o,r=[a.bookTitle,a.creator,a.description,e.target.result];o=new pt(r[0],r[1],r[2],r[3],t),n.handleAddBook(o)}))}}},n.handleChange=function(e){e.preventDefault(),n.setState({isRepeat:!1});var t=e.target.files[0];console.log(t),n.doIncrementalTest(t)},n.state={isRepeat:!1},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"import-from-local"},"\u4ece\u672c\u5730\u5bfc\u5165",o.a.createElement("input",{type:"file",id:"import-book-box",accept:"application/epub+zip",className:"import-book-box",name:"file",multiple:"multiple",onChange:function(t){e.handleChange(t)}}))}}]),t}(a.Component),bt={handleMessageBox:j,handleMessage:C,handleFetchBooks:B},kt=ft=Object(p.b)((function(e){return{books:e.manager.books}}),bt)(ft),vt={isChoose:!1};function Et(e){return{type:"HANDLE_CHOOSE",payload:e}}var yt=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).UNSAFE_componentWillReceiveProps=function(e){n.setState({isSort:e.isSort,isSortDisplay:e.isSortDisplay,sortCode:e.sortCode})},n.handleSortBooks=function(){console.log(n.state.isSortDisplay,"ahdgslahg"),n.state.isSortDisplay?n.props.handleSortDisplay(!1):n.props.handleSortDisplay(!0)},n.handleChoose=function(){n.props.handleChoose(!0)},n.handleOnlyLocal=function(){n.setState({isOnlyLocal:!n.state.isOnlyLocal}),n.props.handleMessage("\u4e0b\u8f7d\u5ba2\u6237\u7aef\u4f53\u9a8c\u5b8c\u6574\u529f\u80fd"),n.props.handleMessageBox(!0)},n.state={isSort:n.props.isSort,sortCode:n.props.sortCode,isSortDisplay:n.props.isSortDisplay,isOnlyLocal:!1},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"header"},o.a.createElement(ht,null),o.a.createElement("div",{className:"header-sort-container",onClick:function(){e.handleSortBooks()}},o.a.createElement("span",{className:"header-sort-text"},"\u6392\u5e8f"),o.a.createElement("span",{className:"icon-sort header-sort-icon"})),this.state.isSort,o.a.createElement("div",{className:"only-local-container"},o.a.createElement("span",{className:"only-local-text"},"\u53ea\u663e\u793a\u672c\u5730\u56fe\u4e66"),o.a.createElement("div",{className:"only-local-icon",onClick:function(){e.handleOnlyLocal()}},o.a.createElement("div",{className:"only-local-slider",style:this.state.isOnlyLocal?{marginLeft:"16px"}:{}}))),o.a.createElement(kt,null),o.a.createElement("div",{className:"import-from-cloud",onClick:function(){e.handleChoose()}},"\u4ece\u4e91\u7aef\u540c\u6b65"))}}]),t}(a.Component),Ot={handleFetchBooks:B,handleSort:S,handleSortCode:D,handleSortDisplay:function(e){return console.log("hdflhghgh",e),{type:"HANDLE_SORT_DISPLAY",payload:e}},handleMessageBox:j,handleMessage:C,handleChoose:Et},St=yt=Object(p.b)((function(e){return{books:e.manager.books,isSearch:e.manager.isSearch,isSortDisplay:e.manager.isSortDisplay}}),Ot)(yt),Nt=(n(58),function(){function e(){Object(i.a)(this,e)}return Object(l.a)(e,null,[{key:"setRecent",value:function(e){var t=localStorage.getItem("recentBooks"),n=JSON.parse(t)||{},a={year:(new Date).getFullYear(),month:(new Date).getMonth()+1,day:(new Date).getDate()};n[e]={bookKey:e,date:a},localStorage.setItem("recentBooks",JSON.stringify(n))}},{key:"getRecent",value:function(){var e=localStorage.getItem("recentBooks");return JSON.parse(e)||{}||null}},{key:"clear",value:function(e){var t=localStorage.getItem("recentBooks"),n=JSON.parse(t)||{};delete n[e],localStorage.setItem("recentBooks",JSON.stringify(n))}}]),e}()),Ct=(n(59),function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleDeleteBook=function(){n.props.handleDeleteDialog(!0),n.props.handleReadingBook(n.props.book)},n.handleEditBook=function(){n.props.handleEditDialog(!0),n.props.handleReadingBook(n.props.book)},n.handleAddShelf=function(){n.props.handleAddDialog(!0),n.props.handleReadingBook(n.props.book)},n.handleConfig=function(e){n.setState({isOpenConfig:e})},n.state={isDeleteDialog:!1,isOpenConfig:!1},n.handleOpenBook=n.handleOpenBook.bind(Object(Be.a)(n)),n.epub=null,n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"UNSAFE_componentWillMount",value:function(){this.epub=window.ePub({bookPath:this.props.book.content,restore:!1})}},{key:"handleOpenBook",value:function(){this.props.handleReadingBook(this.props.book),this.props.handleReadingEpub(this.epub),this.props.handleReadingState(!0),Nt.setRecent(this.props.book.key)}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"book-list-item",onMouseEnter:function(){e.handleConfig(!0)},onMouseLeave:function(){e.handleConfig(!1)}},o.a.createElement("img",{className:"book-item-cover",src:null!==this.props.bookCover?this.props.bookCover:"../../assets/cover.jpg",alt:"",onClick:function(){e.handleOpenBook()}}),o.a.createElement("p",{className:"book-item-title"},this.props.book.name),this.state.isOpenConfig?o.a.createElement("div",{className:"book-item-config"},o.a.createElement("span",{className:"icon-add view-icon",onClick:function(){e.handleAddShelf()}}),o.a.createElement("span",{className:"icon-delete view-icon",onClick:function(){e.handleDeleteBook()}}),o.a.createElement("span",{className:"icon-edit view-icon",onClick:function(){e.handleEditBook()}})):null)}}]),t}(a.Component)),jt={handleReadingState:Ge,handleReadingBook:Je,handleReadingEpub:Ke,handleEditDialog:Pe,handleDeleteDialog:Te,handleAddDialog:ze},Dt=Ct=Object(p.b)((function(e){return{isReading:e.book.isReading}}),jt)(Ct),Bt=(n(60),function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleDeleteBook=function(){n.props.handleDeleteDialog(!0),n.props.handleReadingBook(n.props.book)},n.handleEditBook=function(){n.props.handleEditDialog(!0),n.props.handleReadingBook(n.props.book)},n.handleAddShelf=function(){n.props.handleAddDialog(!0),n.props.handleReadingBook(n.props.book)},n.state={isDeleteDialog:!1},n.handleOpenBook=n.handleOpenBook.bind(Object(Be.a)(n)),n.epub=null,n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"UNSAFE_componentWillMount",value:function(){this.epub=window.ePub({bookPath:this.props.book.content,restore:!1})}},{key:"handleOpenBook",value:function(){this.props.handleReadingBook(this.props.book),this.props.handleReadingEpub(this.epub),this.props.handleReadingState(!0),Nt.setRecent(this.props.book.key)}},{key:"render",value:function(){var e=this,t=null!==Nt.getRecent()[this.props.book.key]&&void 0!==Nt.getRecent()[this.props.book.key]?Nt.getRecent()[this.props.book.key].date:{year:"0000",month:"00",day:"00"},n=null!==U.getCfi(this.props.book.key)&&void 0!==U.getCfi(this.props.book.key)?U.getCfi(this.props.book.key).percentage:0;return o.a.createElement("div",{className:"book-list-item-container"},o.a.createElement("img",{className:"book-item-list-cover",src:null!==this.props.bookCover?this.props.bookCover:"../../assets/cover.jpg",alt:"",onClick:function(){e.handleOpenBook()}}),o.a.createElement("p",{className:"book-item-list-title"},this.props.book.name),o.a.createElement("p",{className:"book-item-list-author"},this.props.book.author),o.a.createElement("p",{className:"book-item-list-date"},t.year+"-"+t.month+"-"+t.day),o.a.createElement("p",{className:"book-item-list-percentage"},Math.round(100*n),"%"),o.a.createElement("div",{className:"book-item-list-config"},o.a.createElement("span",{className:"icon-add list-icon",onClick:function(){e.handleAddShelf()},color:"rgba(75,75,75,1)"}),o.a.createElement("span",{className:"icon-delete list-icon",onClick:function(){e.handleDeleteBook()}}),o.a.createElement("span",{className:"icon-edit list-icon",onClick:function(){e.handleEditBook()}})))}}]),t}(a.Component)),xt={handleReadingState:Ge,handleReadingBook:Je,handleReadingEpub:Ke,handleEditDialog:Pe,handleDeleteDialog:Te,handleAddDialog:ze},At=Bt=Object(p.b)((function(e){return{isReading:e.book.isReading}}),xt)(Bt),It=function(e){var t=[];return e.forEach((function(e){t.push(e.name)})),t},Mt=function(e,t){var n=[];return e.forEach((function(e){n.push(t.indexOf(e))})),n},wt=function(){function e(){Object(i.a)(this,e)}return Object(l.a)(e,null,[{key:"sortBooks",value:function(e,t){if(1===t.sort&&1===t.order){var n=It(e),a=It(e).sort();return Mt(a,n)}if(1===t.sort&&2===t.order){var o=It(e),r=It(e).sort().reverse();return Mt(r,o)}if(2===t.sort&&1===t.order){for(var s=[],i=0;i<e.length;i++)s.push(i);return s}if(2===t.sort&&2===t.order){for(var l=[],c=0;c<e.length;c++)l.push(c);return l.reverse()}}}]),e}(),Lt=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).UNSAFE_componentWillReceiveProps=function(e){n.setState({books:e.books,covers:e.covers,shelfIndex:e.shelfIndex,isSearch:e.isSearch,isSort:e.isSort,sortCode:e.sortCode,searchBooks:e.searchBooks})},n.handleRecent=function(e){var t=[];for(var n in Nt.getRecent())t.push(Nt.getRecent()[n].bookKey);return e.filter((function(e){return t.indexOf(e.key)>-1}))},n.handleChange=function(e){n.setState({isList:e}),localStorage.setItem("isList",e)},n.handleSearch=function(e,t){var n=[];return t.forEach((function(t){n.push(e[t])})),n},n.state={books:n.props.books,covers:n.props.covers,shelfIndex:n.props.shelfIndex,isList:n.props.isList,isSearch:n.props.isSearch,isSort:n.props.isSort,sortCode:n.props.sortCode,searchBooks:n.props.searchBooks},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"handleShelf",value:function(e,t){var n=Object.keys(ot.getShelf())[t+1],a=ot.getShelf()[n];return e.filter((function(e){return a.indexOf(e.key)>-1}))}},{key:"render",value:function(){var e=this;localStorage.setItem("totalBooks",this.props.books.length);return o.a.createElement("div",{className:"book-list-container"},o.a.createElement("div",{className:"book-list-view"},o.a.createElement("div",{className:"card-list-mode",onClick:function(){e.handleChange("card")},style:"card"===this.state.isList?{}:{color:"rgba(75,75,75,0.5)"}},o.a.createElement("span",{className:"icon-grid"})," \u5361\u7247\u6a21\u5f0f"),o.a.createElement("div",{className:"list-view-mode",onClick:function(){e.handleChange("list")},style:"list"===this.state.isList?{}:{color:"rgba(75,75,75,0.5)"}},o.a.createElement("span",{className:"icon-list"})," \u5217\u8868\u6a21\u5f0f")),o.a.createElement("div",{className:"book-list-item-box"},function(){var t="recent"===e.props.mode?e.handleRecent(e.state.books):null!==e.state.shelfIndex?e.handleShelf(e.state.books,e.state.shelfIndex):e.state.isSearch?e.handleSearch(e.state.books,e.props.searchBooks):e.state.isSort?e.handleSearch(e.state.books,wt.sortBooks(e.state.books,e.state.sortCode)):e.state.books,n="recent"===e.props.mode?e.handleRecent(e.state.covers):null!==e.state.shelfIndex?e.handleShelf(e.state.covers,e.state.shelfIndex):e.state.isSearch?e.handleSearch(e.state.covers,e.props.searchBooks):e.state.isSort?e.handleSearch(e.state.covers,wt.sortBooks(e.state.books,e.state.sortCode)):e.state.covers;return t.map((function(t,a){return"list"===e.state.isList?o.a.createElement(At,{key:t.key,book:t,bookCover:n[a]?n[a].url:null}):o.a.createElement(Dt,{key:t.key,book:t,bookCover:n[a]?n[a].url:null})}))}()))}}]),t}(a.Component),Ht=Lt=Object(p.b)((function(e){return{books:e.manager.books,covers:e.manager.covers,epubs:e.manager.epubs,mode:e.sidebar.mode,shelfIndex:e.sidebar.shelfIndex,searchBooks:e.manager.searchBooks,isSearch:e.manager.isSearch,isSort:e.manager.isSort,isList:e.manager.isList,sortCode:e.manager.sortCode}}))(Lt),Ft=(n(61),function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleRedirect=function(e,t,a){for(var o=n.props,r=o.books,s=o.epubs,i={},l={},c=0;c<r.length;c++)if(console.log(r[c].key,e,"key"),r[c].key===e){console.log("sdghasghgh"),i=r[c],l=s[c];break}console.log(n.props.books,i),n.props.handleReadingBook(i),n.props.handleReadingEpub(l),n.props.handleReadingState(!0),Nt.setRecent(e),U.recordCfi(e,t,a)},n.handlePopup=function(e){n.setState({renderIndex:e})},n.handleClose=function(){n.setState({renderIndex:null})},n.state={renderIndex:null},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"UNSAFE_componentWillMount",value:function(){this.props.handleFetchBookmarks()}},{key:"render",value:function(){var e=this,t=this.props,n=t.bookmarks,a=t.books,r=t.covers,s=[];n.forEach((function(e){if(-1===s.indexOf(e.bookKey))return s.push(e.bookKey),!1}));var i=a.filter((function(e){return s.indexOf(e.key)>-1})),l=r.filter((function(e){return s.indexOf(e.key)>-1})),c={};l.forEach((function(e){c[e.key]=e.url}));var u={};n.forEach((function(e){return!u[e.bookKey]&&s.indexOf(e.bookKey)>-1&&(u[e.bookKey]=[]),s.indexOf(e.bookKey)>-1&&u[e.bookKey].push(e),!1})),console.log(u,"bookmarkObj");var d=function(t,n,a){return console.log(u[t.key].length,"fhfjhfjhfk"),o.a.createElement("li",{className:"bookmark-page-item",key:t.key},o.a.createElement("img",{className:"bookmark-page-cover",src:c[t.key],alt:""}),o.a.createElement("p",{className:"bookmark-page-name"},i[n].name),o.a.createElement("ul",{className:"bookmark-page-bookmark-container"},function(t){return u[t.key].map((function(t){return o.a.createElement("li",{className:"bookmark-page-list-item",key:t.key},o.a.createElement("div",{className:"bookmark-page-list-item-title"},t.chapter),o.a.createElement("div",{className:"bookmark-page-progress"},parseInt(100*t.percentage),"%"),o.a.createElement("div",{className:"bookmark-page-list-item-link",onClick:function(){e.handleRedirect(t.bookKey,t.cfi,t.percentage)}},o.a.createElement("div",{className:"bookmark-page-list-item-link-text"},"\u70b9\u51fb\u8df3\u8f6c")))}))}(t)))};return o.a.createElement("div",{className:"bookmark-page-container"},i.map((function(e,t){return o.a.createElement("div",{key:t},d(e,t))})))}}]),t}(a.Component)),_t={handleFetchBookmarks:Ee,handleReadingState:Ge,handleReadingBook:Je,handleReadingEpub:Ke},Rt=Ft=Object(p.b)((function(e){return{state:e,bookmarks:e.reader.bookmarks,covers:e.manager.covers,books:e.manager.books,epubs:e.manager.epubs}}),_t)(Ft),Pt=(n(62),function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleBookName=function(e){for(var t=n.props.books,a="",o=0;o<n.props.books.length;o++)if(console.log(t[o].key===e),t[o].key===e){a=t[o].name;break}return console.log(a,"chapter"),a},n.handleClick=function(e,t){n.state.currentDate?n.setState({currentDate:null,currentIndex:null}):n.setState({currentDate:e,currentIndex:t})},n.state={currentDate:null,currentIndex:null},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.props.notes;console.log(this.props.notes);for(var n=[],a=t.length-1;a>=0;a--)n.push(t[a]);console.log(n[0].date,t,"notesaghsag");for(var r=[n[0].date],s=n[0].date,i=1;i<n.length;i++)console.log(n[i].date),void 0===n[i].date||n[i].date.year===s.year&&n[i].date.month===s.month&&n[i].date.day===s.day||(r.push(n[i].date),s=n[i].date);var l={};console.log(r),r.forEach((function(e){l[""+e.year+e.month+e.day]=[]})),n.forEach((function(e){r.forEach((function(t){t.year===e.date.year&&t.month===e.date.month&&t.day===e.date.day&&l[""+t.year+t.month+t.day].push(e)}))})),console.log(l,"agasgbsg");return console.log(r,n,t,"notesaghsag"),o.a.createElement("div",{className:"note-list-container"},r.map((function(t,n){return o.a.createElement("li",{className:"note-page-item",key:n},o.a.createElement("div",{className:"note-page-item-date"},"".concat(t.year,"\u5e74").concat(t.month,"\u6708").concat(t.day,"\u65e5")),o.a.createElement("ul",{className:"note-list-container-box"},(a=""+t.year+t.month+t.day,l[a].map((function(t,n){console.log(t,"item");var r=e.state.currentDate===a&&e.state.currentIndex===n;return o.a.createElement("li",{className:"note-list-item",key:n,style:r?{height:"200px"}:null},o.a.createElement("div",{className:"note-list-item-note"},t.notes),o.a.createElement("div",{onClick:function(){e.handleClick(a,n)}},o.a.createElement("div",{className:"note-list-item-show-more",style:r?{color:"rgba(75,75,75,0.8)",bottom:"10px"}:{}},r?"\u6536\u8d77":"\u663e\u793a\u7b14\u8bb0\u51fa\u5904"),r?null:o.a.createElement("span",{className:"icon-dropdown note-list-show-more-icon"})),o.a.createElement("div",{className:"note-list-item-more-info",style:r?{display:"block"}:{}},o.a.createElement("div",{className:"note-list-item-more-text"},t.text),o.a.createElement("div",{className:"note-list-item-citation"},o.a.createElement("div",{className:"note-list-item-title"},"\u6765\u81ea\u300a"),o.a.createElement("div",{className:"note-list-item-chapter note-list-item-title"},e.handleBookName(t.bookKey)),o.a.createElement("div",{className:"note-list-item-title"},"\u300b",t.chapter))))})))));var a})))}}]),t}(a.Component)),Tt=Pt=Object(p.b)((function(e){return{notes:e.reader.notes,currentEpub:e.book.currentEpub,currentBook:e.book.currentBook,bookmarks:e.reader.bookmarks,chapters:e.reader.chapters,books:e.manager.books}}),{})(Pt),zt=(n(63),function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleBookName=function(e){for(var t=n.props.books,a="",o=0;o<n.props.books.length;o++)if(console.log(t[o].key===e,"fhgjfhj"),t[o].key===e){a=t[o].name;break}return console.log(t,a,e,"sasbfs"),a},n.state={},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.props.digests;console.log(this.props.digests);for(var n=[],a=t.length-1;a>=0;a--)n.push(t[a]);for(var r=[n[0].date],s=n[0].date,i=1;i<n.length;i++)n[i].date.year===s.year&&n[i].date.month===s.month&&n[i].date.day===s.day||(r.push(n[i].date),s=n[i].date);var l={};r.forEach((function(e){l[""+e.year+e.month+e.day]=[]})),n.forEach((function(e){r.forEach((function(t){t.year===e.date.year&&t.month===e.date.month&&t.day===e.date.day&&l[""+t.year+t.month+t.day].push(e)}))})),console.log(l,"agasgbsg");return console.log(r,n,t,"digestsaghsag"),o.a.createElement("div",{className:"digest-list-container"},r.map((function(t,n){return o.a.createElement("li",{className:"digest-page-item",key:n},o.a.createElement("div",{className:"digest-page-item-date"},"".concat(t.year,"\u5e74").concat(t.month,"\u6708").concat(t.day,"\u65e5")),o.a.createElement("ul",{className:"digest-list-container-box"},(a=""+t.year+t.month+t.day,l[a].map((function(t,n){return o.a.createElement("li",{className:"digest-list-item",key:n},o.a.createElement("div",{className:"digest-list-item-digest"},o.a.createElement("div",{className:"digest-list-item-text"},t.text),o.a.createElement("div",{className:"digest-list-item-citation"},o.a.createElement("div",{className:"digest-list-item-title"},"\u6765\u81ea\u300a"),o.a.createElement("div",{className:"digest-list-item-chapter digest-list-item-title"},e.handleBookName(t.bookKey)),o.a.createElement("div",{className:"digest-list-item-title"},"\u300b",t.chapter))))})))));var a})))}}]),t}(a.Component)),Gt=zt=Object(p.b)((function(e){return{digests:e.reader.digests,currentEpub:e.book.currentEpub,currentBook:e.book.currentBook,bookmarks:e.reader.bookmarks,chapters:e.reader.chapters,books:e.manager.books}}),{})(zt),Jt=(n(64),function(){function e(){Object(i.a)(this,e)}return Object(l.a)(e,null,[{key:"deleteBook",value:function(e,t){for(var n,a=0;a<e.length;a++)if(e[a].key===t){n=a;break}return e.splice(n,1),e}},{key:"deleteBookmarks",value:function(e,t){var n=[];console.log(e);for(var a=0;a<e.length;a++)console.log(e[a].bookKey,t),e[a].bookKey===t&&n.push(a);return console.log(n),n.forEach((function(t){e.splice(t,1)})),e}},{key:"deleteNotes",value:function(e,t){for(var n=[],a=0;a<e.length;a++)e[a].bookKey===t&&n.push(a);return n.forEach((function(t){e.splice(t,1)})),e}},{key:"deleteDigests",value:function(e,t){var n=[];if(console.log("ahhadhg"),console.log(e),void 0!==e){for(var a=0;a<e.length;a++)e[a].bookKey===t&&n.push(a);n.forEach((function(t){e.splice(t,1)}))}return e}},{key:"deleteHighlighters",value:function(e,t){for(var n=[],a=0;a<e.length;a++)e[a].bookKey===t&&n.push(a);return n.forEach((function(t){e.splice(t,1)})),e}}]),e}()),Kt=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){n.props.handleDeleteDialog(!1)},n.handleComfirm=function(){null!==n.props.books&&f.a.setItem("books",Jt.deleteBook(n.props.books,n.props.currentBook.key)).then((function(){n.props.handleDeleteDialog(!1),n.props.handleFetchBooks()})),console.log(n.props.bookmarks,"bookmarks"),n.state.isCheck&&(null!==n.props.bookmarks&&f.a.setItem("bookmarks",Jt.deleteBookmarks(n.props.bookmarks,n.props.currentBook.key)).then((function(){n.props.handleFetchBookmarks()})),console.log(n.props.notes,"notes"),null!==n.props.notes&&f.a.setItem("notes",Jt.deleteNotes(n.props.notes,n.props.currentBook.key)).then((function(){n.props.handleFetchNotes()})),console.log(n.props.digests,"digests"),null!==n.props.digests&&f.a.setItem("digests",Jt.deleteDigests(n.props.digests,n.props.currentBook.key)).then((function(){n.props.handleFetchDigests()})),null!==n.props.highlighters&&f.a.setItem("highlighters",Jt.deleteHighlighters(n.props.highlighters,n.props.currentBook.key)).then((function(){n.props.handleFetchHighlighters()}))),n.props.handleMessage("\u5220\u9664\u6210\u529f"),n.props.handleMessageBox(!0)},n.handleCheck=function(e){n.setState({isCheck:e})},n.state={isCheck:!1},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"delete-dialog-container"},o.a.createElement("div",{className:"delete-dialog-title"},"\u662f\u5426\u5220\u9664\u672c\u56fe\u4e66"),o.a.createElement("div",{className:"delete-dialog-book"},o.a.createElement("div",{className:"delete-dialog-book-title"},this.props.currentBook.name)),o.a.createElement("div",{className:"delete-dialog-other-option"},"\u540c\u65f6\u5220\u9664\u672c\u4e66\u6240\u6709\u7684\u4e66\u7b7e\uff0c\u7b14\u8bb0\uff0c\u4e66\u6458"),this.state.isCheck?o.a.createElement("span",{className:"icon-check",onClick:function(){e.handleCheck(!1)}}):o.a.createElement("span",{className:"delete-dialog-uncheck-icon",onClick:function(){e.handleCheck(!0)}}),o.a.createElement("div",{className:"delete-dialog-cancel",onClick:function(){e.handleCancel()}},"\u53d6\u6d88"),o.a.createElement("div",{className:"delete-dialog-comfirm",onClick:function(){e.handleComfirm()}},"\u5220\u9664"))}}]),t}(a.Component),Ut={handleFetchBooks:B,handleDeleteDialog:Te,handleFetchBookmarks:Ee,handleFetchNotes:ve,handleFetchDigests:ye,handleFetchHighlighters:Oe,handleMessageBox:j,handleMessage:C},qt=Kt=Object(p.b)((function(e){return{books:e.manager.books,isOpenDeleteDialog:e.book.isOpenDeleteDialog,currentBook:e.book.currentBook,bookmarks:e.reader.bookmarks,notes:e.reader.notes,digests:e.reader.digests,highlighters:e.reader.highlighters}}),Ut)(Kt),Wt=(n(65),function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){n.props.handleEditDialog(!1)},n.handleComfirm=function(){var e=document.querySelector(".edit-dialog-book-name-box").value,t=document.querySelector(".edit-dialog-book-author-box").value,a=n.props.books;a.forEach((function(a){if(a.key===n.props.currentBook.key)return a.name=e,a.author=t,!1})),f.a.setItem("books",a).then((function(){n.props.handleEditDialog(!1),n.props.handleFetchBooks()})),n.props.handleMessage("\u7f16\u8f91\u6210\u529f"),n.props.handleMessageBox(!0)},n.state={isCheck:!1},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=document.querySelector(".edit-dialog-book-name-box"),t=document.querySelector(".edit-dialog-book-author-box");console.log(this.props.currentBook),e.value=this.props.currentBook.name,t.value=this.props.currentBook.author}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"edit-dialog-container"},o.a.createElement("div",{className:"edit-dialog-title"},"\u7f16\u8f91\u56fe\u4e66"),o.a.createElement("div",{className:"edit-dialog-book-name-container"},o.a.createElement("div",{className:"edit-dialog-book-name-text"},"\u4e66\u540d"),o.a.createElement("input",{className:"edit-dialog-book-name-box"})),o.a.createElement("div",{className:"edit-dialog-book-author-container"},o.a.createElement("div",{className:"edit-dialog-book-author-text"},"\u4f5c\u8005"),o.a.createElement("input",{className:"edit-dialog-book-author-box"})),o.a.createElement("div",{className:"edit-dialog-cancel",onClick:function(){e.handleCancel()}},"\u53d6\u6d88"),o.a.createElement("div",{className:"edit-dialog-comfirm",onClick:function(){e.handleComfirm()}},"\u786e\u8ba4"))}}]),t}(a.Component)),Qt={handleFetchBooks:B,handleEditDialog:Pe,handleMessageBox:j,handleMessage:C},Vt=Wt=Object(p.b)((function(e){return{books:e.manager.books,isOpenDeleteDialog:e.book.isOpenDeleteDialog,currentBook:e.book.currentBook,bookmarks:e.reader.bookmarks,notes:e.reader.notes,digests:e.reader.digests,highlighters:e.reader.highlighters}}),Qt)(Wt),Yt=(n(66),function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){n.props.handleAddDialog(!1)},n.handleComfirm=function(){var e=document.querySelector(".add-dialog-shelf-list-box").value;n.state.isNew&&(e=document.querySelector(".add-dialog-new-shelf-box").value),ot.setShelf(e,n.props.currentBook.key),n.props.handleAddDialog(!1),n.props.handleMessage("\u6dfb\u52a0\u6210\u529f"),n.props.handleMessageBox(!0)},n.handleChange=function(e){var t=e.target.value;"\u65b0\u5efa\u4e66\u67b6"===t?(n.setState({isNew:!0}),document.querySelector(".add-dialog-new-shelf-box").removeAttribute("disabled")):(n.setState({isNew:!1}),document.querySelector(".add-dialog-new-shelf-box").setAttribute("disabled","diabled")),console.log(t,n.state.isNew)},n.state={isNew:!1},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"add-dialog-container"},o.a.createElement("div",{className:"add-dialog-title"},"\u6dfb\u52a0\u5230\u4e66\u67b6"),o.a.createElement("div",{className:"add-dialog-shelf-list-container"},o.a.createElement("div",{className:"add-dialog-shelf-list-text"},"\u9009\u62e9"),o.a.createElement("select",{className:"add-dialog-shelf-list-box",onChange:function(t){e.handleChange(t)}},function(){var e=ot.getShelf(),t=Object.keys(e);return console.log(t),t.map((function(e,t){return o.a.createElement("option",{value:e,key:t,className:"add-dialog-shelf-list-option"},e)}))}())),o.a.createElement("div",{className:"add-dialog-new-shelf-container"},o.a.createElement("div",{className:"add-dialog-new-shelf-text"},"\u65b0\u5efa"),o.a.createElement("input",{className:"add-dialog-new-shelf-box",disabled:!0})),o.a.createElement("div",{className:"add-dialog-cancel",onClick:function(){e.handleCancel()}},"\u53d6\u6d88"),o.a.createElement("div",{className:"add-dialog-comfirm",onClick:function(){e.handleComfirm()}},"\u786e\u8ba4"))}}]),t}(a.Component)),Xt={handleAddDialog:ze,handleMessageBox:j,handleMessage:C},Zt=Yt=Object(p.b)((function(e){return{books:e.manager.books,isOpenDeleteDialog:e.book.isOpenDeleteDialog,currentBook:e.book.currentBook,bookmarks:e.reader.bookmarks,notes:e.reader.notes,digests:e.reader.digests,highlighters:e.reader.highlighters}}),Xt)(Yt),$t=(n(67),function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).UNSAFE_componentWillReceiveProps=function(e){n.setState({isSort:e.isSort,sortCode:e.sortCode})},n.handleSort=function(e){var t=n.state.sortCode;t.sort=e,console.log(t),n.setState({sortCode:t}),n.props.handleSortCode(t),console.log(n.props.sortCode),y.setSortCode(e,n.state.sortCode.order)},n.handleOrder=function(e){var t=n.state.sortCode;t.order=e,n.setState({sortCode:t}),y.setSortCode(n.state.sortCode.sort,e),n.props.handleSortCode(t),console.log(n.props.sortCode)},n.state={isSort:n.props.isSort,sortCode:n.props.sortCode},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return console.log(this.state.sortCode),o.a.createElement("div",{className:"sort-dialog-container"},o.a.createElement("ul",{className:"sort-by-category"},o.a.createElement("li",{className:"sort-by-category-list",onClick:function(){e.handleSort(1)},style:1===this.state.sortCode.sort?{color:"rgba(75, 75, 75, 1)"}:{}},"\u6309\u540d\u79f0"),o.a.createElement("li",{className:"sort-by-category-list",onClick:function(){e.handleSort(2)},style:2===this.state.sortCode.sort?{color:"rgba(75, 75, 75, 1)"}:{}},"\u6309\u6dfb\u52a0\u65f6\u95f4")),o.a.createElement("div",{className:"sort-dialog-seperator"}),o.a.createElement("ul",{className:"sort-by-order"},o.a.createElement("li",{className:"sort-by-order-list",onClick:function(){e.handleOrder(1)},style:1===this.state.sortCode.order?{color:"rgba(75, 75, 75, 1)"}:{}},"\u987a\u5e8f"),o.a.createElement("li",{className:"sort-by-order-list",onClick:function(){e.handleOrder(2)},style:2===this.state.sortCode.order?{color:"rgba(75, 75, 75, 1)"}:{}},"\u9006\u5e8f")))}}]),t}(a.Component)),en={handleSort:S,handleSortCode:D},tn=$t=Object(p.b)((function(e){return{sortCode:e.manager.sortCode}}),en)($t),nn=(n(68),function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{className:"loading-page-container"},function(){for(var e=[],t=0;t<localStorage.getItem("totalBooks");t++)e.push({});return e.map((function(e,t){return o.a.createElement("div",{className:"loading-page-book",key:t},o.a.createElement("div",{className:"loading-page-cover",style:{opacity:"".concat(t%7*.2+.2)}}))}))}())}}]),t}(a.Component)),an=nn=Object(p.b)((function(e){return{books:e.manager.books}}),{})(nn),on=(n(69),function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleClose=function(){n.props.handleChoose(!1)},n.handleChoose=function(){n.props.handleMessage("\u4e0b\u8f7d\u5ba2\u6237\u7aef\u4f53\u9a8c\u5b8c\u6574\u529f\u80fd"),n.props.handleMessageBox(!0)},n.state={},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"choose-drive-container"},o.a.createElement("div",{className:"choose-drive-title"},"\u7ed1\u5b9a\u60a8\u7684\u7f51\u76d8\u8d26\u53f7"),o.a.createElement("span",{className:"icon-close choose-drive-close-icon",onClick:function(){e.handleClose()}}),o.a.createElement("div",{className:"choose-drive-drive-container"},o.a.createElement("div",null,Y.map((function(t,n){return o.a.createElement("li",{key:t.id,className:"choose-drive-list-item",onClick:function(){e.handleChoose(t.icon,n)}},o.a.createElement("div",{className:"choose-drive-list-item-container"},o.a.createElement("span",{className:"icon-".concat(t.icon," choose-drive-list-icon")}),o.a.createElement("div",{className:"choose-drive-list-title"},t.name)))})))))}}]),t}(a.Component)),rn={handleChoose:Et,handleMessageBox:j,handleMessage:C},sn=on=Object(p.b)((function(e){return{}}),rn)(on),ln=(n(70),function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).UNSAFE_componentWillReceiveProps=function(e){n.setState({mode:e.mode})},n.state={mode:n.props.mode},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"empty-page-container"},o.a.createElement("img",{src:"../../assets/empty.jpg",alt:"",className:"empty-page-illustration"}),X.map((function(t){return o.a.createElement("div",{className:"empty-page-info-container",key:t.mode,style:e.state.mode===t.mode?{}:{visibility:"hidden"}},o.a.createElement("div",{className:"empty-page-info-main"},t.main),o.a.createElement("div",{className:"empty-page-info-sub"},t.sub))})))}}]),t}(a.Component)),cn=ln=Object(p.b)((function(e){return{mode:e.sidebar.mode}}),{})(ln),un=(n(71),function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={mode:n.props.mode,shelfIndex:n.props.shelfIndex,books:n.props.books,notes:n.props.notes,digests:n.props.digests,covers:n.props.covers,bookmarks:n.props.bookmarks,isOpenEditDialog:n.props.isOpenEditDialog,isOpenDeleteDialog:n.props.isOpenDeleteDialog,isOpenAddDialog:n.props.isOpenAddDialog,isSort:n.props.isSort,isSortDisplay:n.props.isSortDisplay,isMessage:!1,isChoose:!1,totalBooks:localStorage.getItem("totalBooks")||0},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"UNSAFE_componentWillMount",value:function(){this.props.handleFetchBooks(),this.props.handleFetchNotes(),this.props.handleFetchDigests(),this.props.handleFetchBookmarks(),this.props.handleFetchHighlighters(),this.props.handleFetchSortCode(),this.props.handleList(localStorage.getItem("isList")||!1)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this;this.setState({mode:e.mode,shelfIndex:e.shelfIndex,books:e.books,notes:e.notes,covers:e.covers,digests:e.digests,bookmarks:e.bookmarks,isOpenDeleteDialog:e.isOpenDeleteDialog,isOpenEditDialog:e.isOpenEditDialog,isOpenAddDialog:e.isOpenAddDialog,isSort:e.isSort,isSortDisplay:e.isSortDisplay,isMessage:e.isMessage,isChoose:e.isChoose}),console.log(this.state.books,"books"),this.setState({totalBooks:null===this.state.books?0:this.state.books.length}),localStorage.setItem("totalBooks",this.state.totalBooks),e.isMessage&&setTimeout((function(){t.props.handleMessageBox(!1),t.setState({isMessage:!1})}),2e3)}},{key:"render",value:function(){var e=this.state,t=e.mode,n=e.notes,a=e.digests,r=e.bookmarks,s=e.covers,i=e.totalBooks;return console.log(this.state.totalBooks,"toatl"),o.a.createElement("div",{className:"manager"},o.a.createElement(ct,null),o.a.createElement(St,null),o.a.createElement("div",{className:"manager-dialog-container"},this.state.isOpenDeleteDialog?o.a.createElement(qt,null):this.state.isOpenEditDialog?o.a.createElement(Vt,null):this.state.isOpenAddDialog?o.a.createElement(Zt,null):null),this.state.isMessage?o.a.createElement(Ve,null):null,this.state.isSortDisplay?o.a.createElement(tn,null):null,this.state.isChoose?o.a.createElement(sn,null):null,0===i?o.a.createElement(cn,null):null===s?o.a.createElement(an,null):"home"===t||"recent"===t||"shelf"===t?o.a.createElement(Ht,null):null!==r&&"bookmark"===t?o.a.createElement(Rt,null):null!==n&&void 0!==n&&"note"===t?o.a.createElement(Tt,null):null!==a&&"digest"===t?o.a.createElement(Gt,null):o.a.createElement(an,null))}}]),t}(a.Component)),dn={handleFetchBooks:B,handleFetchNotes:ve,handleFetchDigests:ye,handleFetchBookmarks:Ee,handleFetchHighlighters:Oe,handleFetchSortCode:function(){return function(e){e(D(y.getSortCode()))}},handleFetchList:function(){return function(e){e(N(localStorage.getItem("isList")||"card"))}},handleList:N,handleMessageBox:j},hn=un=Object(p.b)((function(e){return{books:e.manager.books,covers:e.manager.covers,notes:e.reader.notes,digests:e.reader.digests,bookmarks:e.reader.bookmarks,isReading:e.book.isReading,mode:e.sidebar.mode,shelfIndex:e.sidebar.shelfIndex,isOpenEditDialog:e.book.isOpenEditDialog,isOpenDeleteDialog:e.book.isOpenDeleteDialog,isOpenAddDialog:e.book.isOpenAddDialog,isSort:e.manager.isSort,isSortDisplay:e.manager.isSortDisplay,isMessage:e.manager.isMessage,isChoose:e.chooseDrive.isChoose}}),dn)(un),pn=(n(72),n(73),function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return this.props.isReading?o.a.createElement(tt,null):o.a.createElement(hn,null)}}]),t}(a.Component)),mn=pn=Object(p.b)((function(e){return{isReading:e.book.isReading}}),{})(pn),gn=n(11),fn=n(24),bn=Z.get(),kn={fontSize:bn.fontSize,theme:bn.theme,fontFamily:bn.fontFamily,fontWeight:bn.fontWeight,lineHeight:bn.lineHeight,letterSpacing:bn.letterSpacing,wordSpacing:bn.wordSpacing,column:bn.column,padding:bn.padding};var vn=Object(gn.c)({settingPanel:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:kn,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CHANGE_FONT_SIZE":return Object(E.a)({},e,{fontSize:t.payload});case"CHANGE_BACKGROUND":return Object(E.a)({},e,{background:t.payload});case"CHANGE_FONT":return Object(E.a)({},e,{fontFamily:t.payload});case"CHANGE_FONT_WEIGHT":return Object(E.a)({},e,{fontWeight:t.payload});case"CHANGE_LINE_HEIGHT":return Object(E.a)({},e,{lineHeight:t.payload});case"CHANGE_PADDING":return Object(E.a)({},e,{padding:t.payload});case"CHANGE_WORD_SPACING":return Object(E.a)({},e,{wordSpacing:t.payload});case"CHANGE_COLUMN":return Object(E.a)({},e,{column:t.payload});default:return e}},book:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Re,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"HANDLE_EDIT_DIALOG":return Object(E.a)({},e,{isOpenEditDialog:t.payload});case"HANDLE_DELETE_DIALOG":return Object(E.a)({},e,{isOpenDeleteDialog:t.payload});case"HANDLE_ADD_DIALOG":return Object(E.a)({},e,{isOpenAddDialog:t.payload});case"HANDLE_READING_STATE":return Object(E.a)({},e,{isReading:t.payload});case"HANDLE_READING_BOOK":return Object(E.a)({},e,{currentBook:t.payload});case"HANDLE_READING_EPUB":return Object(E.a)({},e,{currentEpub:t.payload});case"HANDLE_REDIRECT":return Object(E.a)({},e,{isRedirect:!0});default:return e}},manager:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"HANDLE_BOOKS":return Object(E.a)({},e,{books:t.payload});case"HANDLE_SEARCH_BOOKS":return Object(E.a)({},e,{searchBooks:t.payload});case"HANDLE_SEARCH":return Object(E.a)({},e,{isSearch:t.payload});case"HANDLE_SORT":return Object(E.a)({},e,{isSort:t.payload});case"HANDLE_LIST":return Object(E.a)({},e,{isList:t.payload});case"HANDLE_SORT_DISPLAY":return Object(E.a)({},e,{isSortDisplay:t.payload});case"HANDLE_MESSAGE":return Object(E.a)({},e,{message:t.payload});case"HANDLE_MESSAGE_BOX":return Object(E.a)({},e,{isMessage:t.payload});case"HANDLE_SORT_CODE":return Object(E.a)({},e,{sortCode:{sort:t.payload.sort,order:t.payload.order}});case"HANDLE_NOTES":return Object(E.a)({},e,{notes:t.payload});case"HANDLE_BOOKMARKS":return Object(E.a)({},e,{bookmarks:t.payload});case"HANDLE_EPUBS":return Object(E.a)({},e,{epubs:t.payload});case"HANDLE_COVERS":return Object(E.a)({},e,{covers:t.payload});default:return e}},reader:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ge,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"HANDLE_BOOKMARKS":return Object(E.a)({},e,{bookmarks:t.payload});case"HANDLE_NOTES":return Object(E.a)({},e,{notes:t.payload});case"HANDLE_DIGESTS":return Object(E.a)({},e,{digests:t.payload});case"HANDLE_LOCATIONS":return Object(E.a)({},e,{locations:t.payload});case"HANDLE_SECTION":return Object(E.a)({},e,{section:t.payload});case"HANDLE_SINGLE":return Object(E.a)({},e,{isSingle:t.payload});case"HANDLE_CHAPTERS":return Object(E.a)({},e,{chapters:t.payload});case"HANDLE_HIGHLIGHTERS":return Object(E.a)({},e,{highlighters:t.payload});default:return e}},progressPanel:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ee,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"HANDLE_PERCENTAGE":return Object(E.a)({},e,{percentage:t.payload});case"HANDLE_SECTION":return Object(E.a)({},e,{section:t.payload});case"HANDLE_LOCATIONS":return Object(E.a)({},e,{locations:t.payload});default:return e}},viewArea:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"HANDLE_OPEN_MENU":return Object(E.a)({},e,{isOpenMenu:t.payload});case"HANDLE_OPEN_HIGHLIGHT":return Object(E.a)({},e,{isOpenHighlight:t.payload});case"HANDLE_OPEN_NOTE":return Object(E.a)({},e,{isOpenNote:t.payload});case"HANDLE_SELECTION":return Object(E.a)({},e,{selection:t.payload});case"HANDLE_DIALOG_LOCATION":return Object(E.a)({},e,{dialogLocation:t.payload});default:return e}},sidebar:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"HANDLE_MODE":return Object(E.a)({},e,{mode:t.payload});case"HANDLE_SHELF_INDEX":return Object(E.a)({},e,{shelfIndex:t.payload});default:return e}},chooseDrive:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:vt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"HANDLE_CHOOSE":return Object(E.a)({},e,{isChoose:t.payload});default:return e}}}),En=Object(gn.e)(vn,Object(gn.d)(Object(gn.a)(fn.a),window.devToolsExtension?window.devToolsExtension():function(e){return e}));s.a.render(o.a.createElement(p.a,{store:En},o.a.createElement(mn,null)),document.getElementById("root"))}]),[[25,1,2]]]);
//# sourceMappingURL=main.efe0d978.chunk.js.map